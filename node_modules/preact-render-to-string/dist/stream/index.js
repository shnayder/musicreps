var e=require("preact"),t="__s",r="__c",n="__d",o="__s",i=/[\s\n\\/='"\0<>]/,a=/^(xlink|xmlns|xml)([A-Z])/,s=/^(?:accessK|auto[A-Z]|cell|ch|col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z])/,c=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,l=new Set(["draggable","spellcheck"]);function u(e){void 0!==e.__g?e.__g|=8:e[n]=!0}function p(e){void 0!==e.__g?e.__g&=-9:e[n]=!1}function f(e){return void 0!==e.__g?!!(8&e.__g):!0===e[n]}var d=/["&<]/;function h(e){if(0===e.length||!1===d.test(e))return e;for(var t=0,r=0,n="",o="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:o="&quot;";break;case 38:o="&amp;";break;case 60:o="&lt;";break;default:continue}r!==t&&(n+=e.slice(t,r)),n+=o,t=r+1}return r!==t&&(n+=e.slice(t,r)),n}var v={},m=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),g=/[A-Z]/g;function _(e){var t="";for(var r in e){var n=e[r];if(null!=n&&""!==n){var o="-"==r[0]?r:v[r]||(v[r]=r.replace(g,"-$&").toLowerCase()),i=";";"number"!=typeof n||o.startsWith("--")||m.has(o)||(i="px;"),t=t+o+":"+n+i}}return t||void 0}function y(){this.__d=!0}function b(e,t){return{__v:e,context:t,props:e.props,setState:y,forceUpdate:y,__d:!0,__h:new Array(0)}}var x,k,w,C,S=function(){var e=this;this.promise=new Promise(function(t,r){e.resolve=t,e.reject=r})},E={},A=[],L=Array.isArray,P=Object.assign,T="",j="\x3c!--$s--\x3e",F="\x3c!--/$s--\x3e";function W(r,n,o){var i=e.options[t];e.options[t]=!0,x=e.options.__b,k=e.options.diffed,w=e.options.__r,C=e.options.unmount;var a=e.h(e.Fragment,null);a.__k=[r];try{var s=N(r,n||E,!1,void 0,a,!1,o);return L(s)?s.join(T):s}catch(e){if(e.then)throw new Error('Use "renderToStringAsync" for suspenseful rendering.');throw e}finally{e.options.__c&&e.options.__c(r,A),e.options[t]=i,A.length=0}}function D(e,t){var n,i=e.type,a=!0;return e[r]?(a=!1,(n=e[r]).state=n[o]):n=new i(e.props,t),e[r]=n,n.__v=e,n.props=e.props,n.context=t,u(n),null==n.state&&(n.state=E),null==n[o]&&(n[o]=n.state),i.getDerivedStateFromProps?n.state=P({},n.state,i.getDerivedStateFromProps(n.props,n.state)):a&&n.componentWillMount?(n.componentWillMount(),n.state=n[o]!==n.state?n[o]:n.state):!a&&n.componentWillUpdate&&n.componentWillUpdate(),w&&w(e),n.render(n.props,n.state,t)}function N(t,n,d,v,m,g,y){if(null==t||!0===t||!1===t||t===T)return T;var S=typeof t;if("object"!=S)return"function"==S?T:"string"==S?h(t):t+T;if(L(t)){var A,W=T;m.__k=t;for(var U=t.length,Z=0;Z<U;Z++){var q=t[Z];if(null!=q&&"boolean"!=typeof q){var H,I=N(q,n,d,v,m,g,y);"string"==typeof I?W+=I:(A||(A=new Array(U)),W&&A.push(W),W=T,L(I)?(H=A).push.apply(H,I):A.push(I))}}return A?(W&&A.push(W),A):W}if(void 0!==t.constructor)return T;t.__=m,x&&x(t);var O=t.type,R=t.props;if("function"==typeof O){var z,B,V,K=n;if(O===e.Fragment){if("tpl"in R){for(var Y=T,G=0;G<R.tpl.length;G++)if(Y+=R.tpl[G],R.exprs&&G<R.exprs.length){var J=R.exprs[G];if(null==J)continue;"object"!=typeof J||void 0!==J.constructor&&!L(J)?Y+=J:Y+=N(J,n,d,v,t,g,y)}return Y}if("UNSTABLE_comment"in R)return"\x3c!--"+h(R.UNSTABLE_comment)+"--\x3e";B=R.children}else{if(null!=(z=O.contextType)){var Q=n[z.__c];K=Q?Q.props.value:z.__}var X=O.prototype&&"function"==typeof O.prototype.render;if(X)B=/**#__NOINLINE__**/D(t,K),V=t[r];else{t[r]=V=/**#__NOINLINE__**/b(t,K);for(var ee=0;f(V)&&ee++<25;){p(V),w&&w(t);try{B=O.call(V,R,K)}catch(e){throw g&&e&&"function"==typeof e.then&&(t._suspended=!0),e}}u(V)}if(null!=V.getChildContext&&(n=P({},n,V.getChildContext())),X&&e.options.errorBoundaries&&(O.getDerivedStateFromError||V.componentDidCatch)){B=null!=B&&B.type===e.Fragment&&null==B.key&&null==B.props.tpl?B.props.children:B;try{return N(B,n,d,v,t,g,!1)}catch(i){return O.getDerivedStateFromError&&(V[o]=O.getDerivedStateFromError(i)),V.componentDidCatch&&V.componentDidCatch(i,E),f(V)?(B=D(t,n),null!=(V=t[r]).getChildContext&&(n=P({},n,V.getChildContext())),N(B=null!=B&&B.type===e.Fragment&&null==B.key&&null==B.props.tpl?B.props.children:B,n,d,v,t,g,y)):T}finally{k&&k(t),C&&C(t)}}}B=null!=B&&B.type===e.Fragment&&null==B.key&&null==B.props.tpl?B.props.children:B;try{var te=N(B,n,d,v,t,g,y);return k&&k(t),e.options.unmount&&e.options.unmount(t),t._suspended?"string"==typeof te?j+te+F:L(te)?(te.unshift(j),te.push(F),te):te.then(function(e){return j+e+F}):te}catch(r){if(!g&&y&&y.onError){var re=function e(r){return y.onError(r,t,function(t,r){try{return N(t,n,d,v,r,g,y)}catch(t){return e(t)}})}(r);if(void 0!==re)return re;var ne=e.options.__e;return ne&&ne(r,t),T}if(!g)throw r;if(!r||"function"!=typeof r.then)throw r;return r.then(function e(){try{var r=N(B,n,d,v,t,g,y);return t._suspended?j+r+F:r}catch(t){if(!t||"function"!=typeof t.then)throw t;return t.then(e)}})}}var oe,ie="<"+O,ae=T;for(var se in R){var ce=R[se];if("function"!=typeof(ce=M(ce)?ce.value:ce)||"class"===se||"className"===se){switch(se){case"children":oe=ce;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in R)continue;se="for";break;case"className":if("class"in R)continue;se="class";break;case"defaultChecked":se="checked";break;case"defaultSelected":se="selected";break;case"defaultValue":case"value":switch(se="value",O){case"textarea":oe=ce;continue;case"select":v=ce;continue;case"option":v!=ce||"selected"in R||(ie+=" selected")}break;case"dangerouslySetInnerHTML":ae=ce&&ce.__html;continue;case"style":"object"==typeof ce&&(ce=_(ce));break;case"acceptCharset":se="accept-charset";break;case"httpEquiv":se="http-equiv";break;default:if(a.test(se))se=se.replace(a,"$1:$2").toLowerCase();else{if(i.test(se))continue;"-"!==se[4]&&!l.has(se)||null==ce?d?c.test(se)&&(se="panose1"===se?"panose-1":se.replace(/([A-Z])/g,"-$1").toLowerCase()):s.test(se)&&(se=se.toLowerCase()):ce+=T}}null!=ce&&!1!==ce&&(ie=!0===ce||ce===T?ie+" "+se:ie+" "+se+'="'+("string"==typeof ce?h(ce):ce+T)+'"')}}if(i.test(O))throw new Error(O+" is not a valid HTML tag name in "+ie+">");if(ae||("string"==typeof oe?ae=h(oe):null!=oe&&!1!==oe&&!0!==oe&&(ae=N(oe,n,"svg"===O||"foreignObject"!==O&&d,v,t,g,y))),k&&k(t),C&&C(t),!ae&&$.has(O))return ie+"/>";var le="</"+O+">",ue=ie+">";return L(ae)?[ue].concat(ae,[le]):"string"!=typeof ae?[ue,ae,le]:ue+ae+le}var $=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]);function M(e){return null!==e&&"object"==typeof e&&"function"==typeof e.peek&&"value"in e}function U(e,t){return'<preact-island hidden data-target="'+e+'">'+t+"</preact-island>"}var Z=function e(t){try{var r=function(){if(t.suspended.length>0){var r=[].concat(t.suspended);return Promise.resolve(Promise.all(t.suspended.map(function(e){return e.promise}))).then(function(){return t.suspended=t.suspended.filter(function(e){return!r.includes(e)}),Promise.resolve(e(t)).then(function(){})})}}();return Promise.resolve(r&&r.then?r.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},q=function(e,t){var r=t.context,n=t.onWrite,o=t.abortSignal;try{r=r||{};var i={start:Date.now(),abortSignal:o,onWrite:n,onError:H,suspended:[]},a=W(e,r,i),s=i.suspended.length,c=function(){if(s>0){var e=a.lastIndexOf("</body>"),t=a.trimStart().startsWith("<html"),r=-1!==e?a.slice(0,e):a;return n((t?"<!DOCTYPE html>":"")+r),n("<div hidden>"),n('<script>(function(){class e extends HTMLElement{connectedCallback(){var e=this;if(!e.isConnected)return;let t=this.getAttribute("data-target");if(t){for(var r,a,i=document.createNodeIterator(document,128);i.nextNode();){let e=i.referenceNode;if(e.data=="preact-island:"+t?r=e:e.data=="/preact-island:"+t&&(a=e),r&&a)break}r&&a&&r.parentNode!==document&&requestAnimationFrame((()=>{for(var t=a.previousSibling;t!=r&&t&&t!=r;)a.parentNode.removeChild(t),t=a.previousSibling;for(i=r;e.firstChild;)r=e.firstChild,e.removeChild(r),i.after(r),i=r;e.parentNode.removeChild(e)}))}}}customElements.define("preact-island",e);}())<\/script>'),Promise.resolve(Z(i)).then(function(){n("</div>"),-1!==e&&n(a.slice(e))})}n(a)}();return Promise.resolve(c&&c.then?c.then(function(){}):void 0)}catch(e){return Promise.reject(e)}};function H(e,t,n){var o=this;if(e&&e.then){for(;t=t.__;){var i=t[r];if(i&&i.__c)break}if(t){var a=t.__v,s=this.suspended.find(function(e){return e.id===a}),c=new S,l=this.abortSignal;l&&(l.aborted?c.resolve():l.addEventListener("abort",c.resolve));var u=e.then(function(){if(!l||!l.aborted){var e=n(t.props.children,t);e&&o.onWrite(U(a,e))}},this.onError);this.suspended.push({id:a,vnode:t,promise:Promise.race([u,c.promise])});var p=n(t.props.fallback);return s?"":"\x3c!--preact-island:"+a+"--\x3e"+p+"\x3c!--/preact-island:"+a+"--\x3e"}}}exports.renderToReadableStream=function(e,t){var r=new S,n=new TextEncoder("utf-8"),o=new ReadableStream({start:function(o){q(e,{context:t,onError:function(e){r.reject(e),o.abort(e)},onWrite:function(e){o.enqueue(n.encode(e))}}).then(function(){o.close(),r.resolve()}).catch(function(e){o.error(e),r.reject(e)})}});return o.allReady=r.promise,o};
//# sourceMappingURL=index.js.map
