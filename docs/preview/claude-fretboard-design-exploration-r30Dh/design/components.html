<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Design System — Music Reps</title>
  <!-- Pull in the real stylesheet so CSS variables are live -->
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Override app layout for this reference page */
    body {
      max-width: 720px;
      padding: 2rem 1rem;
      min-height: auto;
      color: var(--color-text);
      line-height: 1.5;
    }
    h1 { font-size: 1.5rem; margin: 0 0 0.25rem; }
    .subtitle { color: var(--color-text-muted); font-size: 0.9rem; margin-bottom: 2rem; }
    h2 {
      font-size: 1.1rem;
      margin: 2.5rem 0 0.75rem;
      padding-bottom: 0.25rem;
      border-bottom: 1px solid var(--color-border-lighter);
    }
    h3 {
      font-size: 0.95rem;
      margin: 1.5rem 0 0.5rem;
      color: var(--color-text-muted);
    }
    p { font-size: 0.85rem; color: var(--color-text-muted); margin: 0 0 1rem; }
    code {
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
      font-size: 0.8em;
      background: var(--color-surface);
      padding: 0.1em 0.35em;
      border-radius: 3px;
    }

    /* Showcase panels */
    .showcase {
      border: 1px solid var(--color-border-light);
      border-radius: 8px;
      overflow: hidden;
      margin: 0.75rem 0;
    }
    .showcase-label {
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: var(--color-text-light);
      padding: 0.4rem 0.75rem;
      background: var(--color-surface);
      border-bottom: 1px solid var(--color-border-lighter);
    }
    .showcase-body {
      padding: 1rem;
    }
    .showcase-row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin: 0.5rem 0;
    }
    .showcase-col {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin: 0.5rem 0;
    }

    /* Annotation text */
    .anno {
      font-size: 0.7rem;
      color: var(--color-text-light);
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
    }
    .anno-block {
      font-size: 0.7rem;
      color: var(--color-text-light);
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
      margin-top: 0.35rem;
    }

    /* Spacing visualizer */
    .space-track {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin: 0.3rem 0;
    }
    .space-bar {
      height: 20px;
      background: var(--color-brand);
      border-radius: 3px;
      opacity: 0.7;
    }
    .space-label {
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
      font-size: 0.75rem;
      color: var(--color-text-muted);
      min-width: 7rem;
    }
    .space-value {
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
      font-size: 0.7rem;
      color: var(--color-text-light);
      min-width: 4rem;
    }

    /* Type scale */
    .type-row {
      display: flex;
      align-items: baseline;
      gap: 0.75rem;
      margin: 0.4rem 0;
      padding: 0.3rem 0;
      border-bottom: 1px solid var(--color-border-lighter);
    }
    .type-row:last-child { border-bottom: none; }
    .type-label {
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
      font-size: 0.7rem;
      color: var(--color-text-light);
      min-width: 6.5rem;
    }
    .type-size {
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
      font-size: 0.7rem;
      color: var(--color-text-muted);
      min-width: 4rem;
    }
    .type-sample {
      color: var(--color-text);
    }
    .type-usage {
      font-size: 0.7rem;
      color: var(--color-text-light);
      margin-left: auto;
    }

    /* Radius showcase */
    .radius-row {
      display: flex;
      gap: 1rem;
      align-items: end;
      flex-wrap: wrap;
    }
    .radius-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.3rem;
    }
    .radius-shape {
      width: 60px;
      height: 48px;
      border: 2px solid var(--color-border);
      background: var(--color-surface);
    }

    /* Shadow showcase */
    .shadow-card {
      width: 120px;
      height: 72px;
      background: var(--color-bg);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      color: var(--color-text-muted);
    }

    /* Alignment guides */
    .align-demo {
      border: 1px dashed var(--color-border-light);
      border-radius: 6px;
      padding: 0.75rem;
    }

    /* Touch target overlay */
    .touch-box {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .touch-outline {
      position: absolute;
      border: 1px dashed var(--color-error);
      border-radius: 4px;
      pointer-events: none;
    }

    /* Transition demo */
    .transition-demo {
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      border: 2px solid var(--color-border);
      background: var(--color-bg);
      color: var(--color-text);
      transition: background 0.15s ease, border-color 0.15s ease, transform 0.1s ease;
    }
    .transition-demo:hover {
      background: var(--color-surface-hover);
      border-color: var(--color-text);
    }
    .transition-demo:active {
      transform: scale(0.97);
      background: var(--color-surface-pressed);
    }

    /* Grid demo */
    .grid-cell {
      background: var(--color-surface);
      border: 1px solid var(--color-border-light);
      border-radius: 4px;
      padding: 0.5rem;
      font-size: 0.75rem;
      color: var(--color-text-muted);
      text-align: center;
    }

    /* Nav link */
    .page-nav {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      font-size: 0.8rem;
    }
    .page-nav a {
      color: var(--color-brand-dark);
      text-decoration: none;
    }
    .page-nav a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>Design System</h1>
  <div class="subtitle">
    Components, spacing, layout &amp; interaction patterns &mdash; all using live
    values from <code>src/styles.css</code>.
  </div>
  <div class="page-nav">
    <a href="colors.html">Color System &rarr;</a>
  </div>

  <!-- ================================================================== -->
  <h2>Spacing Scale</h2>
  <p>6 tokens from 2px to 24px. Used for all gaps, padding, and margins.</p>
  <div id="spacing-scale"></div>

  <!-- ================================================================== -->
  <h2>Typography Scale</h2>
  <p>7 size tokens. Font weights: 400 (normal), 500 (medium &mdash; buttons/labels),
     600 (semibold &mdash; headings). System font stack.</p>
  <div id="type-scale"></div>

  <h3>Font Weights in Context</h3>
  <div class="showcase">
    <div class="showcase-label">Weight usage</div>
    <div class="showcase-body">
      <div style="font-weight: 400; margin-bottom: 0.3rem;">400 &mdash; Body text, stats, descriptions</div>
      <div style="font-weight: 500; margin-bottom: 0.3rem;">500 &mdash; Buttons, labels, nav items</div>
      <div style="font-weight: 600; margin-bottom: 0.3rem;">600 &mdash; Headings, active tab, CTA</div>
      <div style="font-weight: 700;">700 &mdash; Round-complete heading only</div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Border Radius</h2>
  <p>Consistent rounding across component types.</p>
  <div class="showcase">
    <div class="showcase-label">Radius tokens</div>
    <div class="showcase-body">
      <div class="radius-row" id="radius-demo"></div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Shadows</h2>
  <p>Used sparingly &mdash; only on elevated elements.</p>
  <div class="showcase">
    <div class="showcase-label">Elevation levels</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <div class="shadow-card" style="box-shadow: none; border: 1px solid var(--color-border-light);">
          <div>Flat<br><span class="anno">cards, tables</span></div>
        </div>
        <div class="shadow-card" style="box-shadow: 0 2px 8px rgba(0,0,0,0.12);">
          <div>Low<br><span class="anno">CTA button</span></div>
        </div>
        <div class="shadow-card" style="box-shadow: 0 4px 24px rgba(0,0,0,0.2);">
          <div>High<br><span class="anno">modal, drawer</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Buttons</h2>

  <h3>Primary CTA</h3>
  <p>One per screen. Sage brand fill, white text, subtle shadow.</p>
  <div class="showcase">
    <div class="showcase-label">Start Quiz variants</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <button class="start-btn" style="margin:0;">Start Quiz</button>
        <span class="anno">default</span>
      </div>
      <div class="anno-block">
        background: var(--color-brand) &middot; border: 2px solid var(--color-brand)<br>
        font-weight: 600 &middot; border-radius: 8px &middot; shadow: 0 2px 8px rgba(0,0,0,0.12)<br>
        :hover &rarr; --color-brand-dark &middot; :active &rarr; scale(0.98)
      </div>
    </div>
  </div>

  <h3>Secondary Buttons</h3>
  <p>Outlined, not filled. For stop/recalibrate/continue actions.</p>
  <div class="showcase">
    <div class="showcase-label">Secondary variants</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <button class="recalibrate-btn" style="display:inline; margin:0;">Recalibrate</button>
        <button class="round-complete-stop" style="margin:0;">Stop</button>
        <span class="anno">outlined, muted text</span>
      </div>
    </div>
  </div>

  <h3>Round-Complete Actions</h3>
  <p>Paired primary + secondary at end of quiz round.</p>
  <div class="showcase">
    <div class="showcase-label">Action pair</div>
    <div class="showcase-body">
      <div class="round-complete-actions">
        <button class="round-complete-continue" style="margin:0;">Continue</button>
        <button class="round-complete-stop" style="margin:0;">Stop</button>
      </div>
      <div class="anno-block">gap: var(--space-3) &middot; justify-content: center</div>
    </div>
  </div>

  <h3>Answer Buttons</h3>
  <p>48px tall, 2px muted border, grid layout. Accidentals use accent background.</p>
  <div class="showcase">
    <div class="showcase-label">Note buttons &mdash; piano layout (14-col grid)</div>
    <div class="showcase-body">
      <div class="note-buttons" style="max-width: 420px;">
        <div class="note-row-accidentals">
          <button class="note-btn accidental">C#</button>
          <button class="note-btn accidental">D#</button>
          <button class="note-btn accidental">F#</button>
          <button class="note-btn accidental">G#</button>
          <button class="note-btn accidental">A#</button>
        </div>
        <div class="note-row-naturals">
          <button class="note-btn">C</button>
          <button class="note-btn">D</button>
          <button class="note-btn">E</button>
          <button class="note-btn">F</button>
          <button class="note-btn">G</button>
          <button class="note-btn">A</button>
          <button class="note-btn">B</button>
        </div>
      </div>
      <div class="anno-block">
        naturals: 2-col span each &middot; accidentals: offset between naturals<br>
        accidental bg: var(--color-surface-accent) &middot; height: 48px
      </div>
    </div>
  </div>

  <div class="showcase">
    <div class="showcase-label">Answer grid &mdash; 4-column (numbers, intervals, etc.)</div>
    <div class="showcase-body">
      <div class="answer-buttons" style="max-width: 320px;">
        <button class="answer-btn">0</button>
        <button class="answer-btn">1</button>
        <button class="answer-btn">2</button>
        <button class="answer-btn">3</button>
        <button class="answer-btn">4</button>
        <button class="answer-btn">5</button>
        <button class="answer-btn">6</button>
        <button class="answer-btn">7</button>
      </div>
      <div class="anno-block">grid-template-columns: repeat(4, 1fr) &middot; gap: 0.4rem</div>
    </div>
  </div>

  <div class="showcase">
    <div class="showcase-label">Answer grid &mdash; 3-column (intervals)</div>
    <div class="showcase-body">
      <div class="answer-buttons answer-buttons-intervals" style="max-width: 280px;">
        <button class="answer-btn">m2</button>
        <button class="answer-btn">M2</button>
        <button class="answer-btn">m3</button>
        <button class="answer-btn">M3</button>
        <button class="answer-btn">P4</button>
        <button class="answer-btn">TT</button>
      </div>
      <div class="anno-block">grid-template-columns: repeat(3, 1fr)</div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Toggles</h2>

  <h3>String Toggles</h3>
  <p>Small square buttons for selecting strings/distances. Three states.</p>
  <div class="showcase">
    <div class="showcase-label">Toggle states</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <div class="string-toggles">
          <button class="string-toggle">E</button>
          <button class="string-toggle active">A</button>
          <button class="string-toggle active recommended">D</button>
          <button class="string-toggle">G</button>
          <button class="string-toggle recommended">B</button>
          <button class="string-toggle">E</button>
        </div>
      </div>
      <div class="anno-block">
        inactive: surface bg, border color text &middot; active: --color-toggle-active fill<br>
        recommended: 2px --color-toggle-recommended glow &middot; 36px &times; 36px
      </div>
    </div>
  </div>

  <h3>Stats Toggle (Recall / Speed)</h3>
  <p>Segmented control using brand color for active state.</p>
  <div class="showcase">
    <div class="showcase-label">Segmented toggle</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <div class="stats-toggle">
          <button class="stats-toggle-btn active" style="margin:0;">Recall</button>
          <button class="stats-toggle-btn" style="margin:0;">Speed</button>
        </div>
        <span class="anno">brand fill on active, not success green</span>
      </div>
    </div>
  </div>

  <h3>Settings Toggle Group</h3>
  <p>Used in settings modal for mutually exclusive options.</p>
  <div class="showcase">
    <div class="showcase-label">Settings toggle</div>
    <div class="showcase-body">
      <div style="max-width: 240px;">
        <div class="settings-toggle-group">
          <button class="settings-toggle-btn active" style="margin:0;">Letters</button>
          <button class="settings-toggle-btn" style="margin:0;">Solf&egrave;ge</button>
        </div>
      </div>
      <div class="anno-block">border-radius: 8px container &middot; active: brand fill</div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Tabs</h2>
  <p>Practice / Progress tab switcher. Bottom border indicator.</p>
  <div class="showcase">
    <div class="showcase-label">Mode tabs</div>
    <div class="showcase-body">
      <div class="mode-tabs" style="margin-bottom: 0;">
        <button class="mode-tab active" style="margin: 0;">Practice</button>
        <button class="mode-tab" style="margin: 0;">Progress</button>
      </div>
      <div class="anno-block">
        active: --color-brand-dark text, --color-brand bottom border, font-weight 600<br>
        inactive: --color-text-muted, transparent border, font-weight 500
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Cards &amp; Surfaces</h2>

  <h3>Quiz Area Card</h3>
  <p>Contains prompt, answer buttons, and feedback during active quiz.</p>
  <div class="showcase">
    <div class="showcase-label">Quiz card (active phase)</div>
    <div class="showcase-body">
      <div style="background: var(--color-surface); border-radius: 12px; padding: var(--space-5); border: 1px solid var(--color-border-lighter); text-align: center; max-width: 400px;">
        <div style="font-size: var(--text-2xl); font-weight: 600; margin-bottom: var(--space-3);">What note?</div>
        <div style="display: flex; justify-content: center; gap: var(--space-3); margin-bottom: var(--space-3);">
          <button class="answer-btn" style="width: 56px;">C</button>
          <button class="answer-btn" style="width: 56px;">D</button>
          <button class="answer-btn" style="width: 56px;">E</button>
        </div>
        <div style="font-size: var(--text-xl); font-weight: 600; color: var(--color-success);">Correct!</div>
        <div style="color: var(--color-text-muted); font-size: var(--text-sm); margin-top: var(--space-3);">0.45s</div>
      </div>
      <div class="anno-block">
        bg: var(--color-surface) &middot; border-radius: 12px &middot; padding: var(--space-5)<br>
        active border: 1px solid var(--color-border-lighter)
      </div>
    </div>
  </div>

  <h3>Practice Card</h3>
  <p>Consolidated card: status + recommendation + scope toggles + CTA.</p>
  <div class="showcase">
    <div class="showcase-label">Practice card</div>
    <div class="showcase-body">
      <div class="practice-card" style="max-width: 400px;">
        <div class="practice-status">
          <span class="practice-status-label">Consolidating</span>
          <span class="practice-status-detail">Master current strings before adding more</span>
        </div>
        <div class="practice-recommendation">
          <span class="practice-rec-text">Recommended: add string B</span>
          <button class="practice-rec-btn" style="margin: 0;">Apply</button>
        </div>
      </div>
      <div class="anno-block">bg: var(--color-surface) &middot; border-radius: 8px &middot; padding: --space-4 --space-5</div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Feedback &amp; Slots</h2>

  <h3>Feedback Text</h3>
  <div class="showcase">
    <div class="showcase-label">Correct / incorrect feedback</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <span style="font-size: var(--text-xl); font-weight: 600; color: var(--color-success);">Correct!</span>
        <span style="font-size: var(--text-xl); font-weight: 600; color: var(--color-error);">Wrong &mdash; it was C</span>
      </div>
      <div class="anno-block">font-size: var(--text-xl) &middot; font-weight: 600</div>
    </div>
  </div>

  <h3>Chord Spelling Slots</h3>
  <p>Sequential fill with 4 distinct states.</p>
  <div class="showcase">
    <div class="showcase-label">Slot lifecycle</div>
    <div class="showcase-body">
      <div class="chord-slots" style="justify-content: flex-start;">
        <span class="chord-slot">_</span>
        <span class="chord-slot active">_</span>
        <span class="chord-slot correct">C</span>
        <span class="chord-slot wrong">D</span>
      </div>
      <div class="showcase-row" style="margin-top: 0.5rem;">
        <span class="anno">empty</span>
        <span class="anno" style="margin-left: 1.4rem;">active (focus)</span>
        <span class="anno" style="margin-left: 0.3rem;">correct</span>
        <span class="anno" style="margin-left: 0.8rem;">wrong</span>
      </div>
      <div class="anno-block">
        3rem &times; 2.5rem &middot; border: 2px &middot; border-radius: 6px<br>
        active: focus-bg + focus border &middot; correct: success-bg &middot; wrong: error-bg
      </div>
    </div>
  </div>

  <h3>Mastery Message</h3>
  <div class="showcase">
    <div class="showcase-label">Success banner</div>
    <div class="showcase-body">
      <div class="mastery-message" style="display: block;">
        All items mastered! Great work.
      </div>
      <div class="anno-block">bg: var(--color-success-bg) &middot; color: var(--color-success-text) &middot; border-radius: 6px</div>
    </div>
  </div>

  <h3>Round Complete Stats</h3>
  <p>Three stats shown at end of each round.</p>
  <div class="showcase">
    <div class="showcase-label">End-of-round summary</div>
    <div class="showcase-body">
      <div style="text-align: center; padding: var(--space-4) 0;">
        <div style="font-size: var(--text-lg); font-weight: 600; margin-bottom: var(--space-4);">Round 1 complete</div>
        <div style="display: flex; justify-content: center; gap: var(--space-6);">
          <div style="display: flex; flex-direction: column;">
            <span style="font-size: var(--text-xl); font-weight: 600;">8 / 12</span>
            <span style="font-size: var(--text-xs); color: var(--color-text-muted);">correct</span>
          </div>
          <div style="display: flex; flex-direction: column;">
            <span style="font-size: var(--text-xl); font-weight: 600;">1.2s</span>
            <span style="font-size: var(--text-xs); color: var(--color-text-muted);">median time</span>
          </div>
          <div style="display: flex; flex-direction: column;">
            <span style="font-size: var(--text-xl); font-weight: 600;">5 / 24</span>
            <span style="font-size: var(--text-xs); color: var(--color-text-muted);">fluent</span>
          </div>
        </div>
      </div>
      <div class="anno-block">
        value: --text-xl font-weight 600 &middot; label: --text-xs --color-text-muted<br>
        layout: flex row, gap --space-6
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Progress &amp; Timing</h2>

  <h3>Progress Bar</h3>
  <div class="showcase">
    <div class="showcase-label">Round progress</div>
    <div class="showcase-body">
      <div style="max-width: 300px; margin: 0 auto;">
        <div class="progress-bar">
          <div class="progress-fill" style="width: 65%;"></div>
          <div class="progress-text">13 / 20</div>
        </div>
      </div>
      <div class="anno-block">
        max-width: 300px &middot; height: 20px &middot; border-radius: 10px<br>
        fill: var(--color-success) &middot; bg: var(--color-surface-alt) &middot; transition: width 0.3s
      </div>
    </div>
  </div>

  <h3>Quiz Session Info</h3>
  <p>Compact info row below the countdown bar during active quiz.</p>
  <div class="showcase">
    <div class="showcase-label">Countdown bar + info row</div>
    <div class="showcase-body">
      <div style="max-width: 400px;">
        <div class="quiz-countdown-bar" style="margin: 0 0 var(--space-2) 0;">
          <div class="quiz-countdown-fill" style="width: 65%;"></div>
        </div>
        <div class="quiz-session-info" style="margin: 0;">
          <span class="quiz-info-context">e, B strings</span>
          <span class="quiz-info-time">0:42</span>
          <span class="quiz-info-count">13 answers</span>
          <button class="quiz-header-close" style="margin: 0;">&times;</button>
        </div>
      </div>
      <div class="anno-block">
        countdown: 4px height, brand fill depleting over 60s, red in last 10s<br>
        info row: font-size var(--text-sm), color var(--color-text-muted), tabular-nums
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Navigation</h2>

  <h3>Home Screen</h3>
  <p>Full-screen mode selector. Entry point for the app.</p>
  <div class="showcase">
    <div class="showcase-label">Mode cards with group labels</div>
    <div class="showcase-body" style="padding: 0;">
      <div style="max-width: 360px; padding: var(--space-4);">
        <div class="home-group-label">Fretboard</div>
        <button class="home-mode-btn" style="pointer-events: none;">
          <span class="home-mode-name">Guitar Fretboard</span>
          <span class="home-mode-desc">Name notes on the guitar neck</span>
        </button>
        <button class="home-mode-btn" style="pointer-events: none;">
          <span class="home-mode-name">Ukulele Fretboard</span>
          <span class="home-mode-desc">Name notes on the ukulele</span>
        </button>
        <div class="home-group-label">Theory Lookup</div>
        <button class="home-mode-btn" style="pointer-events: none;">
          <span class="home-mode-name">Note &harr; Semitones</span>
          <span class="home-mode-desc">Convert notes to semitone numbers</span>
        </button>
      </div>
      <div class="anno-block" style="padding: 0.5rem 0.75rem;">
        mode buttons: flex column, 1px border, 8px radius<br>
        group labels: uppercase, --text-xs, letter-spacing 0.05em, --color-text-muted
      </div>
    </div>
  </div>

  <h3>Mode Top Bar</h3>
  <p>Back button + mode title. Hidden during quiz/calibration.</p>
  <div class="showcase">
    <div class="showcase-label">Mode header</div>
    <div class="showcase-body" style="padding: 0;">
      <div class="mode-top-bar" style="margin: 0; padding: var(--space-3) var(--space-4);">
        <button class="mode-back-btn" style="margin: 0;">&larr;</button>
        <h1 class="mode-title">Guitar Fretboard</h1>
      </div>
      <div class="anno-block" style="padding: 0.5rem 0.75rem;">
        back button: 44px touch target, --text-xl &middot; title: --text-lg, font-weight 600<br>
        hidden during phase-active, phase-calibration, phase-round-complete
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Fretboard</h2>
  <p>The primary quiz surface for guitar and ukulele modes. SVG scales to fill
     container width via <code>viewBox</code> + <code>width: 100%</code>.</p>

  <h3>Full Guitar Fretboard (6 strings, 13 frets)</h3>
  <div class="showcase">
    <div class="showcase-label">Idle / heatmap view (all notes labeled)</div>
    <div class="showcase-body" id="fretboard-full"></div>
  </div>

  <h3>Quiz Highlight States</h3>
  <p>During a quiz, one note is highlighted. After answering, it turns green or red.</p>
  <div class="showcase">
    <div class="showcase-label">Question &rarr; correct &rarr; wrong</div>
    <div class="showcase-body" id="fretboard-states"></div>
  </div>

  <h3>Fret Markers</h3>
  <p>Inlay dots at standard positions (3, 5, 7, 9, double at 12) give orientation
     without adding clutter.</p>
  <div class="showcase">
    <div class="showcase-label">Marker positions</div>
    <div class="showcase-body" id="fretboard-markers-demo"></div>
  </div>

  <h3>Anatomy &amp; Dimensions</h3>
  <div class="showcase">
    <div class="showcase-label">SVG coordinate system</div>
    <div class="showcase-body">
      <div class="anno-block">
        viewBox: 0 0 600 <em>h</em> &mdash; guitar h=240, ukulele h=160<br>
        string spacing: 40px &middot; first string y=20 &middot; note circle r=15 &middot; font-size: 12, font-weight: 600<br>
        fret spacing: decreasing (65, 61, 57, 54, 51, 48, 45, 42, 40, 37, 35, 33, 32)<br>
        nut: stroke-width 4 at fretPositions[1] &middot; fret markers below SVG as HTML divs<br>
        CSS scales: width:100%, height:auto &middot; max-width: 1200px
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Heatmap &amp; Stats</h2>

  <h3>Heatmap Cells</h3>
  <p>Color-coded stat cells used in progress tables and grids.</p>
  <div class="showcase">
    <div class="showcase-label">Cell states</div>
    <div class="showcase-body">
      <div class="showcase-row" id="heatmap-cells"></div>
      <div class="anno-block">
        stats-cell: 40&times;28px (table), 30&times;24px (grid) &middot; border-radius: 4px<br>
        text flips to white at level 3+ (L &le; 50%)
      </div>
    </div>
  </div>

  <h3>Legend</h3>
  <div class="showcase">
    <div class="showcase-label">Heatmap legend strip</div>
    <div class="showcase-body">
      <div class="heatmap-legend active" id="legend-demo" style="display: flex;"></div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Layout Patterns</h2>

  <h3>Content Width</h3>
  <p>App max-width is 650px. Quiz card and progress content live within this.</p>
  <div class="showcase">
    <div class="showcase-label">Width constraints</div>
    <div class="showcase-body">
      <div class="showcase-col">
        <div class="space-track">
          <span class="space-label">body</span>
          <span class="space-value">650px</span>
          <div style="width: 100%; height: 12px; background: var(--color-surface-alt); border-radius: 2px; border: 1px dashed var(--color-border-light);"></div>
        </div>
        <div class="space-track">
          <span class="space-label">answer-buttons</span>
          <span class="space-value">360px</span>
          <div style="width: 55%; height: 12px; background: var(--color-brand); opacity: 0.3; border-radius: 2px;"></div>
        </div>
        <div class="space-track">
          <span class="space-label">progress-bar</span>
          <span class="space-value">300px</span>
          <div style="width: 46%; height: 12px; background: var(--color-brand); opacity: 0.3; border-radius: 2px;"></div>
        </div>
        <div class="space-track">
          <span class="space-label">settings-modal</span>
          <span class="space-value">280px</span>
          <div style="width: 43%; height: 12px; background: var(--color-brand); opacity: 0.3; border-radius: 2px;"></div>
        </div>
      </div>
    </div>
  </div>

  <h3>Centering Patterns</h3>
  <div class="showcase">
    <div class="showcase-label">Alignment conventions</div>
    <div class="showcase-body">
      <div class="showcase-col">
        <div class="align-demo" style="text-align: center;">
          <div class="anno" style="margin-bottom: 0.3rem;">text-align: center</div>
          <div>Quiz prompt, feedback, progress bar, session stats, start button</div>
        </div>
        <div class="align-demo" style="display: flex; justify-content: center; gap: var(--space-3);">
          <div class="anno" style="position: absolute; margin-top: -1rem;">flex + justify-content: center</div>
          <div style="padding: 0.3rem 0.8rem; background: var(--color-surface); border-radius: 4px; margin-top: 0.8rem;">Toggle</div>
          <div style="padding: 0.3rem 0.8rem; background: var(--color-surface); border-radius: 4px; margin-top: 0.8rem;">Groups</div>
          <div style="padding: 0.3rem 0.8rem; background: var(--color-surface); border-radius: 4px; margin-top: 0.8rem;">Here</div>
        </div>
        <div class="align-demo" style="display: flex; justify-content: center;">
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.3rem; max-width: 240px; width: 100%;">
            <div class="grid-cell">1</div>
            <div class="grid-cell">2</div>
            <div class="grid-cell">3</div>
            <div class="grid-cell">4</div>
          </div>
        </div>
        <div class="anno">margin: 0 auto + max-width for answer grids</div>
      </div>
    </div>
  </div>

  <h3>Grid Layouts</h3>
  <div class="showcase">
    <div class="showcase-label">Column patterns used across the app</div>
    <div class="showcase-body">
      <div class="showcase-col">
        <div class="anno">4-column: numbers, notes (12-note), key sigs, degrees, numerals</div>
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.3rem; max-width: 240px;">
          <div class="grid-cell">1</div><div class="grid-cell">2</div><div class="grid-cell">3</div><div class="grid-cell">4</div>
        </div>

        <div class="anno" style="margin-top: 0.75rem;">3-column: intervals</div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.3rem; max-width: 200px;">
          <div class="grid-cell">m2</div><div class="grid-cell">M2</div><div class="grid-cell">m3</div>
        </div>

        <div class="anno" style="margin-top: 0.75rem;">14-column: piano note layout (7 naturals &times; 2 cols + 5 offset accidentals)</div>
        <div style="display: grid; grid-template-columns: repeat(14, 1fr); gap: 1px; max-width: 280px;">
          <div class="grid-cell" style="grid-column: 1/3;">C</div>
          <div class="grid-cell" style="grid-column: 3/5;">D</div>
          <div class="grid-cell" style="grid-column: 5/7;">E</div>
          <div class="grid-cell" style="grid-column: 7/9;">F</div>
          <div class="grid-cell" style="grid-column: 9/11;">G</div>
          <div class="grid-cell" style="grid-column: 11/13;">A</div>
          <div class="grid-cell" style="grid-column: 13/15;">B</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Touch Targets</h2>
  <p>Minimum 44px on all interactive elements (WCAG / Apple HIG).</p>
  <div class="showcase">
    <div class="showcase-label">Target sizing</div>
    <div class="showcase-body">
      <div class="showcase-row" id="touch-targets"></div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Interaction &amp; Motion</h2>

  <h3>Transitions</h3>
  <p>Color: 0.15s ease. Transform: 0.1s ease. Progress: 0.3s ease. Countdown: 0.2s linear.</p>
  <div class="showcase">
    <div class="showcase-label">Hover &amp; press (try it)</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <button class="transition-demo" style="margin: 0;">Hover me</button>
        <button class="start-btn" style="margin: 0;">Press me</button>
        <button class="note-btn" style="width: 56px; margin: 0;">A</button>
      </div>
      <div class="anno-block">
        color transitions: 0.15s ease &middot; scale: 0.1s ease<br>
        @media (prefers-reduced-motion: reduce) &rarr; all transitions 0.01ms
      </div>
    </div>
  </div>

  <h3>Focus States</h3>
  <div class="showcase">
    <div class="showcase-label">Keyboard navigation (tab to see)</div>
    <div class="showcase-body">
      <div class="showcase-row">
        <button class="note-btn" style="width: 56px; margin: 0;">C</button>
        <button class="start-btn" style="margin: 0;">Start</button>
        <button class="answer-btn" style="width: 56px; margin: 0;">5</button>
      </div>
      <div class="anno-block">
        :focus-visible &rarr; 2px solid var(--color-brand), offset 2px<br>
        :focus:not(:focus-visible) &rarr; outline: none (mouse/touch)
      </div>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Phase Visibility</h2>
  <p>Each mode screen uses a phase class to show/hide groups of elements.
     No JS display toggling &mdash; CSS handles it all.</p>
  <div class="showcase">
    <div class="showcase-label">Phase &rarr; visible elements</div>
    <div class="showcase-body">
      <table style="border-collapse: collapse; font-size: 0.8rem; width: 100%;">
        <thead>
          <tr>
            <th style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; background: var(--color-surface); text-align: left;">Phase class</th>
            <th style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; background: var(--color-surface); text-align: center;">Tabs</th>
            <th style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; background: var(--color-surface); text-align: center;">Quiz Session</th>
            <th style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; background: var(--color-surface); text-align: center;">Quiz Area</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; font-weight: 500;">.phase-idle</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-success);">visible</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-text-light);">hidden</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-text-light);">hidden</td>
          </tr>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; font-weight: 500;">.phase-active</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-text-light);">hidden</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-success);">visible</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-success);">visible</td>
          </tr>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; font-weight: 500;">.phase-calibration</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-text-light);">hidden</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-success);">visible</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-success);">visible</td>
          </tr>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; font-weight: 500;">.phase-round-complete</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-text-light);">hidden</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-success);">visible</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; text-align: center; color: var(--color-success);">visible</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ================================================================== -->
  <h2>Mobile Breakpoint</h2>
  <p>Single breakpoint at 599px. Changes body padding, removes side borders,
     shrinks answer grids to 3-column, and prevents iOS zoom on focus.</p>
  <div class="showcase">
    <div class="showcase-label">@media (max-width: 599px)</div>
    <div class="showcase-body">
      <table style="border-collapse: collapse; font-size: 0.8rem; width: 100%;">
        <thead>
          <tr>
            <th style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; background: var(--color-surface); text-align: left;">Property</th>
            <th style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; background: var(--color-surface); text-align: left;">Desktop</th>
            <th style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem; background: var(--color-surface); text-align: left;">Mobile</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">body padding</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">0 var(--space-5)</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">0 var(--space-1)</td>
          </tr>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">body border</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">1px side borders</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">none</td>
          </tr>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">answer-buttons columns</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">repeat(4, 1fr)</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">repeat(3, 1fr)</td>
          </tr>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">quiz-prompt size</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">var(--text-2xl) / 2rem</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">1.6rem</td>
          </tr>
          <tr>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">button font-size</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">inherited</td>
            <td style="border: 1px solid var(--color-border-light); padding: 0.35rem 0.5rem;">16px (prevents iOS zoom)</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    function v(name) {
      return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    }

    // --- Spacing scale ---
    (function() {
      var tokens = [
        { v: '--space-1', desc: 'Toggle gaps, pixel-level' },
        { v: '--space-2', desc: 'Button grid gaps, tight padding' },
        { v: '--space-3', desc: 'Standard gap, small padding' },
        { v: '--space-4', desc: 'Section gaps, nav padding' },
        { v: '--space-5', desc: 'Body padding, section spacing' },
        { v: '--space-6', desc: 'Large section gaps' },
      ];
      var el = document.getElementById('spacing-scale');
      el.innerHTML = tokens.map(function(t) {
        var val = v(t.v);
        // Convert to px for the bar width
        var px = parseFloat(val) * 16;
        return '<div class="space-track">'
          + '<span class="space-label">' + t.v + '</span>'
          + '<span class="space-value">' + val + '</span>'
          + '<span class="space-bar" style="width:' + Math.max(px * 3, 4) + 'px;"></span>'
          + '<span class="anno">' + t.desc + '</span>'
          + '</div>';
      }).join('');
    })();

    // --- Type scale ---
    (function() {
      var tokens = [
        { v: '--text-xs',  usage: 'Legend labels, tiny stats' },
        { v: '--text-sm',  usage: 'Session stats, settings, table text' },
        { v: '--text-base',usage: 'Body, buttons, nav items' },
        { v: '--text-md',  usage: 'Answer buttons, note buttons' },
        { v: '--text-lg',  usage: 'Mode title, answer count' },
        { v: '--text-xl',  usage: 'Back button, feedback, close buttons' },
        { v: '--text-2xl', usage: 'Home title, quiz prompts' },
      ];
      var el = document.getElementById('type-scale');
      el.innerHTML = tokens.map(function(t) {
        var val = v(t.v);
        return '<div class="type-row">'
          + '<span class="type-label">' + t.v + '</span>'
          + '<span class="type-size">' + val + '</span>'
          + '<span class="type-sample" style="font-size:' + val + ';">Ag 0–9 C#</span>'
          + '<span class="type-usage">' + t.usage + '</span>'
          + '</div>';
      }).join('');
    })();

    // --- Border radius ---
    (function() {
      var radii = [
        { r: '3px', label: '3px', usage: 'legend swatch' },
        { r: '4px', label: '4px', usage: 'toggle, heatmap cell, fret number' },
        { r: '6px', label: '6px', usage: 'chord slot, mastery, small btn' },
        { r: '8px', label: '8px', usage: 'CTA, answer btn, practice summary, settings' },
        { r: '10px', label: '10px', usage: 'progress bar' },
        { r: '12px', label: '12px', usage: 'quiz card, settings modal' },
      ];
      var el = document.getElementById('radius-demo');
      el.innerHTML = radii.map(function(r) {
        return '<div class="radius-box">'
          + '<div class="radius-shape" style="border-radius:' + r.r + ';"></div>'
          + '<span class="anno">' + r.label + '</span>'
          + '<span class="anno">' + r.usage + '</span>'
          + '</div>';
      }).join('');
    })();

    // --- Heatmap cells ---
    (function() {
      var levels = [
        { v: '--heatmap-none', label: 'none', light: true },
        { v: '--heatmap-1', label: '1', light: true },
        { v: '--heatmap-2', label: '2', light: true },
        { v: '--heatmap-3', label: '3', light: false },
        { v: '--heatmap-4', label: '4', light: false },
        { v: '--heatmap-5', label: '5', light: false },
      ];
      var el = document.getElementById('heatmap-cells');
      el.innerHTML = levels.map(function(l) {
        var bg = v(l.v);
        var color = l.light ? 'var(--color-text)' : 'white';
        return '<div style="display:flex;flex-direction:column;align-items:center;gap:0.2rem;">'
          + '<div class="stats-cell" style="background:' + bg + ';color:' + color
          + ';display:flex;align-items:center;justify-content:center;font-size:0.7rem;font-weight:600;">'
          + l.label + '</div>'
          + '<span class="anno">' + l.v + '</span>'
          + '</div>';
      }).join('');
    })();

    // --- Legend demo ---
    (function() {
      var items = [
        { v: '--heatmap-none', label: 'No data' },
        { v: '--heatmap-1', label: 'Needs work' },
        { v: '--heatmap-2', label: 'Fading' },
        { v: '--heatmap-3', label: 'Getting there' },
        { v: '--heatmap-4', label: 'Solid' },
        { v: '--heatmap-5', label: 'Automatic' },
      ];
      var el = document.getElementById('legend-demo');
      el.innerHTML = items.map(function(i) {
        return '<div class="legend-item">'
          + '<span class="legend-swatch" style="background:' + v(i.v) + ';"></span>'
          + i.label
          + '</div>';
      }).join('');
    })();

    // --- Touch targets ---
    (function() {
      var targets = [
        { el: '<button class="mode-back-btn" style="margin:0;">&larr;</button>', label: 'back-btn 44px', size: 44 },
        { el: '<button class="note-btn" style="width:56px;margin:0;">C</button>', label: 'note-btn 48px', size: 48 },
        { el: '<button class="answer-btn" style="width:56px;margin:0;">5</button>', label: 'answer-btn 48px', size: 48 },
        { el: '<button class="string-toggle active" style="margin:0;">E</button>', label: 'toggle 36px', size: 36 },
      ];
      var el = document.getElementById('touch-targets');
      el.innerHTML = targets.map(function(t) {
        return '<div style="display:flex;flex-direction:column;align-items:center;gap:0.3rem;">'
          + '<div class="touch-box">'
          + t.el
          + '<div class="touch-outline" style="width:' + t.size + 'px;height:' + t.size + 'px;top:50%;left:50%;transform:translate(-50%,-50%);"></div>'
          + '</div>'
          + '<span class="anno">' + t.label + '</span>'
          + '</div>';
      }).join('');
    })();

    // ================================================================
    // Fretboard generation (mirrors fretboard.ts logic)
    // ================================================================
    (function() {
      var fretPositions = [0, 65, 126, 183, 237, 288, 336, 381, 423, 463, 500, 535, 568, 600];
      // Guitar: standard tuning note names per string (high E to low E)
      var stringOffsets = [4, 11, 7, 2, 9, 4]; // EBGDAE
      var noteNames = ['C','C#','D','D#','E','F','F#','G','G#','A','A#','B'];
      var markers = [3, 5, 7, 9, 12];

      function getNoteAt(string, fret) {
        return noteNames[(stringOffsets[string] + fret) % 12];
      }

      function noteX(fret) {
        if (fret === 0) return fretPositions[0] + (fretPositions[1] - fretPositions[0]) / 2;
        return (fretPositions[fret] + fretPositions[fret + 1]) / 2;
      }

      function buildFretboard(opts) {
        var sc = opts.stringCount || 6;
        var fc = opts.fretCount || 13;
        var h = sc * 40;
        var r = opts.circleRadius || 15;
        var fontSize = opts.fontSize || 12;
        var svg = '';

        // Fret marker dots (between strings, at marker frets)
        var midY = h / 2;
        for (var m = 0; m < markers.length; m++) {
          var fret = markers[m];
          if (fret >= fc) continue;
          var mx = (fretPositions[fret] + fretPositions[fret + 1]) / 2;
          if (fret === 12) {
            // Double dot at fret 12
            var dotY1 = 20 + 1 * 40;
            var dotY2 = 20 + (sc - 2) * 40;
            svg += '<circle class="fret-marker" cx="' + mx + '" cy="' + dotY1 + '" r="5"/>';
            svg += '<circle class="fret-marker" cx="' + mx + '" cy="' + dotY2 + '" r="5"/>';
          } else {
            svg += '<circle class="fret-marker" cx="' + mx + '" cy="' + midY + '" r="5"/>';
          }
        }

        // Nut (wide bar)
        svg += '<rect class="fretboard-nut" x="' + (fretPositions[1] - 3) + '" y="0" width="6" height="' + h + '" rx="1"/>';
        // Frets (start from index 2; index 1 is the nut)
        for (var i = 2; i < fretPositions.length; i++) {
          svg += '<line x1="' + fretPositions[i] + '" y1="0" x2="' + fretPositions[i] + '" y2="' + h + '" stroke="var(--color-fretboard-line)" stroke-width="1"/>';
        }
        // Strings
        for (var s = 0; s < sc; s++) {
          var thickness = 1 + s * 0.5;
          svg += '<line x1="0" y1="' + (20 + s * 40) + '" x2="600" y2="' + (20 + s * 40) + '" stroke="var(--color-fretboard-line)" stroke-width="' + thickness + '"/>';
        }
        // Notes
        for (var si = 0; si < sc; si++) {
          for (var fi = 0; fi < fc; fi++) {
            var x = noteX(fi);
            var y = 20 + si * 40;
            var fill = opts.fillFn ? opts.fillFn(si, fi) : 'var(--color-bg)';
            var stroke = 'var(--color-fretboard-line)';
            var label = opts.labelFn ? opts.labelFn(si, fi) : '';
            var textFill = opts.textFillFn ? opts.textFillFn(si, fi) : 'var(--color-text)';
            svg += '<circle cx="' + x + '" cy="' + y + '" r="' + r + '" fill="' + fill + '" stroke="' + stroke + '" stroke-width="1"/>';
            if (label) {
              svg += '<text x="' + x + '" y="' + y + '" text-anchor="middle" dominant-baseline="central" font-size="' + fontSize + '" fill="' + textFill + '" font-weight="600">' + label + '</text>';
            }
          }
        }

        return '<div class="fretboard-wrapper" style="display:flex;flex-direction:column;align-items:center;width:100%;">'
          + '<div class="fretboard-container" style="position:relative;width:100%;">'
          + '<svg class="fretboard" viewBox="0 0 600 ' + h + '" style="width:100%;height:auto;display:block;background:var(--color-bg);">'
          + svg + '</svg>'
          + '</div></div>';
      }

      // --- Full fretboard with all notes ---
      document.getElementById('fretboard-full').innerHTML = buildFretboard({
        labelFn: function(s, f) { return getNoteAt(s, f); },
      }) + '<div class="anno-block">'
        + 'viewBox: 0 0 600 240 &middot; scales to 100% width &middot; 6 strings &times; 13 frets<br>'
        + 'circle r=15, font-size=12, font-weight=600, string spacing 40px &middot; nut stroke-width: 4'
        + '</div>';

      // --- Quiz highlight states ---
      var highlight = v('--color-highlight');
      var success = v('--color-success');
      var error = v('--color-error');
      document.getElementById('fretboard-states').innerHTML = buildFretboard({
        stringCount: 3, fretCount: 7,
        fillFn: function(s, f) {
          if (s === 1 && f === 3) return highlight;
          if (s === 0 && f === 5) return success;
          if (s === 2 && f === 1) return error;
          return 'var(--color-bg)';
        },
        labelFn: function(s, f) {
          if (s === 0 && f === 5) return 'A';
          if (s === 2 && f === 1) return 'F';
          return '';
        },
        textFillFn: function(s, f) {
          if (s === 0 && f === 5 || s === 2 && f === 1) return 'white';
          return 'var(--color-text)';
        },
      }) + '<div class="showcase-row" style="margin-top:0.5rem;">'
        + '<span style="display:inline-block;width:12px;height:12px;border-radius:50%;background:' + highlight + ';border:1px solid var(--color-border);"></span>'
        + '<span class="anno">question (--color-highlight)</span>'
        + '<span style="display:inline-block;width:12px;height:12px;border-radius:50%;background:' + success + ';margin-left:0.5rem;"></span>'
        + '<span class="anno">correct (--color-success)</span>'
        + '<span style="display:inline-block;width:12px;height:12px;border-radius:50%;background:' + error + ';margin-left:0.5rem;"></span>'
        + '<span class="anno">wrong (--color-error)</span>'
        + '</div>';

      // --- Fret markers demo ---
      document.getElementById('fretboard-markers-demo').innerHTML = buildFretboard({
        stringCount: 4, fretCount: 13,
        labelFn: function() { return ''; },
      }) + '<div class="anno-block">'
        + 'single dot: frets 3, 5, 7, 9 (centered between strings)<br>'
        + 'double dot: fret 12 (between string pairs) &middot; r=5, fill: --color-border-light, opacity 0.6'
        + '</div>';
    })();
  </script>
</body>
</html>
