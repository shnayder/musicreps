<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Component Preview &mdash; Music Reps</title>
  <link rel="stylesheet" href="../../src/styles.css">
  <style>
    :root {
  /* Brand (sage) */
  --color-brand: hsl(90, 35%, 45%);
  --color-brand-dark: hsl(90, 35%, 35%);
  --color-brand-bg: hsl(90, 25%, 94%);

  /* Semantic colors */
  --color-success: #4caf50;
  --color-success-dark: #388e3c;
  --color-success-bg: #e8f5e9;
  --color-success-text: #2e7d32;
  --color-error: #f44336;
  --color-error-bg: #ffebee;
  --color-error-text: #c62828;
  --color-focus: #2196f3;
  --color-focus-bg: #e3f2fd;
  --color-recommended: #ff9800;
  --color-highlight: #ffd700;

  /* UI accents */
  --color-toggle-active: hsl(90, 35%, 42%);
  --color-toggle-recommended: hsl(35, 80%, 55%);

  /* Text (warm neutrals) */
  --color-text: hsl(30, 5%, 20%);
  --color-text-muted: hsl(30, 3%, 40%);
  --color-text-light: hsl(30, 3%, 60%);

  /* Surfaces & backgrounds (warm neutrals) */
  --color-bg: #fff;
  --color-surface: hsl(30, 10%, 96%);
  --color-surface-hover: hsl(30, 8%, 93%);
  --color-surface-alt: hsl(30, 8%, 92%);
  --color-surface-pressed: hsl(30, 5%, 82%);
  --color-surface-accent: hsl(30, 8%, 90%);

  /* Borders (warm neutrals) */
  --color-border: hsl(30, 5%, 60%);
  --color-border-light: hsl(30, 5%, 80%);
  --color-border-lighter: hsl(30, 5%, 86%);

  /* Overlay */
  --color-overlay: rgba(0, 0, 0, 0.35);

  /* Heatmap scale (warm → sage, matches fretboard circle palette) */
  --heatmap-none: hsl(30, 4%, 85%);
  --heatmap-1: hsl(12, 48%, 65%);
  --heatmap-2: hsl(30, 48%, 58%);
  --heatmap-3: hsl(50, 40%, 50%);
  --heatmap-4: hsl(72, 38%, 42%);
  --heatmap-5: hsl(90, 45%, 35%);

  /* Typography scale */
  --text-xs: 0.75rem;
  --text-sm: 0.85rem;
  --text-base: 1rem;
  --text-md: 1.125rem;
  --text-lg: 1.3rem;
  --text-xl: 1.5rem;
  --text-2xl: 2rem;

  /* Spacing scale */
  --space-1: 0.125rem;
  --space-2: 0.25rem;
  --space-3: 0.5rem;
  --space-4: 0.75rem;
  --space-5: 1rem;
  --space-6: 1.5rem;
}

* {
  -webkit-tap-highlight-color: transparent;
}
html {
  background: var(--color-surface);
  overscroll-behavior: none;
}
body {
  font-family: system-ui, -apple-system, sans-serif;
  max-width: 650px;
  margin: 0 auto;
  padding: 0 var(--space-5);
  padding-top: env(safe-area-inset-top, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
  padding-left: max(var(--space-5), env(safe-area-inset-left, 0));
  padding-right: max(var(--space-5), env(safe-area-inset-right, 0));
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  min-height: 100dvh;
  color: var(--color-text);
  background: var(--color-bg);
  border-left: 1px solid var(--color-border-lighter);
  border-right: 1px solid var(--color-border-lighter);
  overscroll-behavior: none;
}

/* --- Home screen --- */
.home-screen {
  display: flex;
  flex-direction: column;
  min-height: 100dvh;
  padding: var(--space-5);
}
.home-screen.hidden {
  display: none;
}
.home-header {
  text-align: center;
  padding: var(--space-6) 0 var(--space-4);
}
.home-title {
  font-size: var(--text-2xl);
  font-weight: 700;
  color: var(--color-text);
  margin: 0;
}
.home-modes {
  flex: 1;
}
.home-group-label {
  font-size: var(--text-xs);
  font-weight: 600;
  text-transform: uppercase;
  color: var(--color-text-muted);
  letter-spacing: 0.05em;
  margin-top: var(--space-5);
  margin-bottom: var(--space-2);
  padding-left: var(--space-2);
}
.home-group-label:first-child {
  margin-top: 0;
}
.home-mode-btn {
  display: flex;
  flex-direction: column;
  width: 100%;
  text-align: left;
  padding: var(--space-4) var(--space-4);
  background: var(--color-bg);
  border: 1px solid var(--color-border-lighter);
  border-radius: 8px;
  margin-bottom: var(--space-2);
  cursor: pointer;
}
.home-mode-btn:hover {
  background: var(--color-surface);
}
.home-mode-btn:active {
  background: var(--color-surface-pressed);
}
.home-mode-name {
  font-size: var(--text-base);
  font-weight: 600;
  color: var(--color-text);
}
.home-mode-desc {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
}
.home-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) 0;
  border-top: 1px solid var(--color-border-lighter);
  margin-top: var(--space-4);
}
.home-settings-btn {
  background: none;
  border: 1px solid var(--color-border-light);
  border-radius: 6px;
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  cursor: pointer;
  margin: 0;
  min-height: 44px;
  display: flex;
  align-items: center;
}
.home-settings-btn:hover {
  background: var(--color-surface-hover);
}
.home-settings-btn:active {
  background: var(--color-surface-pressed);
}
.version {
  font-size: var(--text-xs);
  color: var(--color-text-light);
}

/* --- Mode top bar --- */
.mode-top-bar {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) 0;
  margin-bottom: var(--space-3);
}
.mode-back-btn {
  background: none;
  border: none;
  font-size: var(--text-xl);
  cursor: pointer;
  padding: var(--space-2);
  min-width: 44px;
  min-height: 44px;
  color: var(--color-text-muted);
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
}
.mode-back-btn:hover {
  background: var(--color-surface-hover);
}
.mode-back-btn:active {
  background: var(--color-surface-pressed);
}
.mode-title {
  margin: 0;
  font-size: var(--text-lg);
  font-weight: 600;
  flex: 1;
}
/* Hide back button during active quiz and calibration; keep title visible */
.phase-active .mode-back-btn,
.phase-calibration .mode-back-btn,
.phase-round-complete .mode-back-btn {
  display: none;
}
.phase-active .mode-top-bar,
.phase-calibration .mode-top-bar,
.phase-round-complete .mode-top-bar {
  margin-bottom: 0;
}

/* --- Settings modal --- */
.settings-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--color-overlay);
  z-index: 200;
  justify-content: center;
  align-items: center;
}
.settings-overlay.open {
  display: flex;
}
.settings-modal {
  background: var(--color-bg);
  border-radius: 12px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.2);
  width: 280px;
  max-width: 90vw;
  overflow: hidden;
}
.settings-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-5);
  border-bottom: 1px solid var(--color-border);
}
.settings-title {
  font-weight: 600;
  font-size: var(--text-base);
}
.settings-close-btn {
  background: none;
  border: none;
  font-size: var(--text-xl);
  cursor: pointer;
  color: var(--color-text);
  padding: 0;
  line-height: 1;
  opacity: 0.6;
}
.settings-close-btn:hover {
  opacity: 1;
}
.settings-close-btn:active {
  opacity: 0.4;
}
.settings-body {
  padding: var(--space-5);
}
.settings-field {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}
.settings-label {
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--color-text-muted);
}
.settings-toggle-group {
  display: flex;
  gap: 0;
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid var(--color-border);
}
.settings-toggle-btn {
  flex: 1;
  padding: var(--space-3) var(--space-4);
  border: none;
  background: var(--color-surface);
  cursor: pointer;
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--color-text);
  transition: background 0.15s ease, color 0.15s ease;
}
.settings-toggle-btn + .settings-toggle-btn {
  border-left: 1px solid var(--color-border);
}
.settings-toggle-btn.active {
  background: var(--color-brand);
  color: white;
}
.settings-toggle-btn:hover:not(.active) {
  background: var(--color-surface-hover);
}
.settings-toggle-btn:active {
  opacity: 0.8;
}

/* --- Mode screens --- */
.mode-screen {
  display: none;
  padding-top: var(--space-3);
  flex: 1;
}
.mode-screen.mode-active {
  display: block;
}

/* --- Phase-driven visibility --- */
.quiz-session {
  position: relative;
}
.phase-idle .quiz-session {
  display: none;
}

/* Hide tabs and tab content during non-idle phases */
/* .tab-content.active needs explicit override (higher specificity than .tab-content.active display:block) */
.phase-active .mode-tabs,
.phase-active .tab-content,
.phase-active .tab-content.active,
.phase-calibration .mode-tabs,
.phase-calibration .tab-content,
.phase-calibration .tab-content.active,
.phase-round-complete .mode-tabs,
.phase-round-complete .tab-content,
.phase-round-complete .tab-content.active {
  display: none;
}

/* Element-level visibility (replaces inline style="display: none;") */
.mastery-message {
  display: none;
}
.mastery-message.mastery-visible {
  display: block;
}
.round-complete {
  display: none;
}
.phase-round-complete .round-complete {
  display: block;
}
.stats-container.stats-hidden {
  display: none;
}
.fretboard-wrapper.fretboard-hidden {
  display: none;
}

/* --- Mode tabs (Practice / Progress) --- */
.mode-tabs {
  display: flex;
  gap: 0;
  border-bottom: 2px solid var(--color-border-lighter);
  margin-bottom: var(--space-5);
}
.mode-tab {
  flex: 1;
  padding: var(--space-3) var(--space-5);
  border: none;
  border-bottom: 2px solid transparent;
  margin-bottom: -2px;
  background: none;
  font-size: var(--text-base);
  font-weight: 500;
  color: var(--color-text-muted);
  cursor: pointer;
  transition: color 0.15s ease, border-color 0.15s ease;
}
.mode-tab:hover {
  color: var(--color-text);
}
.mode-tab.active {
  color: var(--color-brand-dark);
  border-bottom-color: var(--color-brand);
  font-weight: 600;
}
.tab-content {
  display: none;
}
.tab-content.active {
  display: block;
}

/* --- Practice card --- */
.practice-card {
  margin-bottom: var(--space-4);
  padding: var(--space-4) var(--space-5);
  background: var(--color-surface);
  border-radius: 8px;
}
.practice-zone + .practice-zone {
  margin-top: var(--space-5);
  padding-top: var(--space-5);
  border-top: 1px solid var(--color-border-lighter);
}
.practice-status {
  margin-bottom: var(--space-3);
}
.practice-status:empty,
.practice-status-label:empty + .practice-status-detail:empty {
  display: none;
}
.practice-status-label {
  font-weight: 600;
  font-size: var(--text-base);
  color: var(--color-text);
}
.practice-status-detail {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  margin-left: var(--space-3);
}
.practice-recommendation {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  flex-wrap: wrap;
}
.practice-recommendation:empty,
.practice-rec-text:empty ~ .practice-rec-btn {
  display: none;
}
.practice-rec-text {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
}
.practice-rec-text:empty {
  display: none;
}
.practice-rec-btn {
  font-size: var(--text-xs);
  font-weight: 500;
  padding: var(--space-2) var(--space-4);
  border: 1px solid var(--color-brand);
  border-radius: 6px;
  background: var(--color-brand-bg);
  color: var(--color-brand-dark);
  cursor: pointer;
  margin: 0;
  transition: background 0.15s ease;
}
.practice-rec-btn:hover {
  background: var(--color-brand);
  color: white;
}
.practice-rec-btn.hidden {
  display: none;
}

/* --- Practice scope (inside practice card) --- */
.practice-scope {
  margin-top: var(--space-4);
}
.practice-scope .settings-row {
  margin-bottom: 0;
}

/* --- Practice action zone (inside practice card) --- */
.practice-zone-action {
  text-align: center;
}
.session-summary-text {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  margin-bottom: var(--space-3);
}
.session-summary-text:empty {
  display: none;
}

/* --- Baseline info (Progress tab) --- */
.baseline-info {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  text-align: center;
  padding: var(--space-3) var(--space-4);
  margin-bottom: var(--space-3);
}
.baseline-info:empty {
  display: none;
}
.baseline-default-tag {
  font-style: italic;
  color: var(--color-text-light);
}
.baseline-rerun-btn {
  background: none;
  border: 1px solid var(--color-border-light);
  border-radius: 6px;
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--color-text-muted);
  cursor: pointer;
  margin: 0;
  margin-left: var(--space-2);
  transition: background 0.15s ease, border-color 0.15s ease;
}
.baseline-rerun-btn:hover {
  background: var(--color-surface-hover);
  border-color: var(--color-border);
}
.baseline-rerun-btn:active {
  background: var(--color-surface-pressed);
}

/* --- Progress tab stats controls (within tab) --- */
.tab-content .stats-controls {
  text-align: center;
  margin: var(--space-3) 0;
  padding-bottom: var(--space-2);
}

/* --- Fretboard --- */
.fretboard-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
}
.string-toggles {
  display: flex;
  flex-direction: row;
  gap: var(--space-1);
  justify-content: center;
}
.string-toggle {
  width: 36px;
  height: 36px;
  border: 1px solid var(--color-border);
  border-radius: 4px;
  background: var(--color-surface);
  color: var(--color-border);
  font-size: var(--text-sm);
  font-weight: 500;
  cursor: pointer;
  padding: 0;
  margin: 0;
  transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
}
.string-toggle:hover {
  background: var(--color-surface-hover);
}
.string-toggle.active {
  background: var(--color-toggle-active);
  color: white;
  border-color: var(--color-toggle-active);
}
.string-toggle.recommended {
  box-shadow: 0 0 0 2px var(--color-toggle-recommended);
}
.string-toggle.active.recommended {
  border-color: var(--color-toggle-recommended);
}
.distance-toggles {
  display: flex;
  flex-direction: row;
  gap: var(--space-1);
  justify-content: center;
}
.distance-toggle {
  height: 36px;
  border: 1px solid var(--color-border);
  border-radius: 4px;
  background: var(--color-surface);
  color: var(--color-border);
  font-size: var(--text-xs);
  font-weight: 500;
  cursor: pointer;
  padding: 0 0.4rem;
  margin: 0;
  transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
}
.distance-toggle:hover {
  background: var(--color-surface-hover);
}
.distance-toggle.active {
  background: var(--color-toggle-active);
  color: white;
  border-color: var(--color-toggle-active);
}
.distance-toggle.recommended {
  box-shadow: 0 0 0 2px var(--color-toggle-recommended);
}
.distance-toggle.active.recommended {
  border-color: var(--color-toggle-recommended);
}
.notes-toggles {
  display: flex;
  flex-direction: row;
  gap: var(--space-1);
  justify-content: center;
}
.notes-toggle {
  height: 36px;
  border: 1px solid var(--color-border);
  border-radius: 4px;
  background: var(--color-surface);
  color: var(--color-border);
  font-size: var(--text-xs);
  font-weight: 500;
  cursor: pointer;
  padding: 0 0.6rem;
  margin: 0;
  transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
}
.notes-toggle:hover {
  background: var(--color-surface-hover);
}
.notes-toggle.active {
  background: var(--color-toggle-active);
  color: white;
  border-color: var(--color-toggle-active);
}
.fretboard-container {
  position: relative;
  width: 100%;
  min-width: 0;
  max-width: 1200px;
}
.fretboard {
  width: 100%;
  height: auto;
  display: block;
  background: var(--color-bg);
  touch-action: manipulation;
}
/* SVG fretboard — new circle-based design */
.fb-string {
  stroke: hsl(30, 8%, 72%);
}
.fb-fret {
  stroke: hsl(30, 5%, 82%);
}
.fb-nut {
  fill: hsl(30, 8%, 48%);
}
.fb-marker {
  fill: hsl(30, 5%, 62%);
}
.fb-pos {
  fill: hsl(30, 5%, 90%);
  stroke: none;
  cursor: pointer;
  transition: fill 0.15s;
}

/* Hover card */
.hover-card {
  position: absolute;
  pointer-events: none;
  z-index: 10;
  opacity: 0;
  transition: opacity 0.12s;
}
.hover-card.visible {
  opacity: 1;
}
.hc-inner {
  background: var(--color-bg);
  border: 1px solid var(--color-border-light);
  border-radius: 8px;
  padding: 0.35rem 0.5rem;
  min-width: 65px;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.12);
  text-align: center;
}
.hc-note {
  font-size: var(--text-sm);
  font-weight: 700;
  color: var(--color-text);
}
.hc-string-fret {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  margin-top: 0.05rem;
}
.hc-detail {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  margin-top: 0.12rem;
}
.hc-bar {
  height: 3px;
  border-radius: 2px;
  background: hsl(30, 5%, 90%);
  margin-top: 0.25rem;
  overflow: hidden;
}
.hc-bar-fill {
  height: 100%;
  border-radius: 2px;
  transition: width 0.2s;
}

.settings-row {
  display: flex;
  align-items: center;
  gap: var(--space-5);
  justify-content: center;
  margin-bottom: var(--space-3);
}
button {
  padding: var(--space-3) var(--space-6);
  font-size: var(--text-base);
  cursor: pointer;
  margin: 0 var(--space-3);
}
.mastery-message {
  background: var(--color-success-bg);
  color: var(--color-success-text);
  font-weight: bold;
  font-size: var(--text-base);
  padding: var(--space-3) var(--space-5);
  margin-bottom: var(--space-3);
  border-radius: 6px;
  text-align: center;
}

/* --- Primary CTA (Start Quiz) --- */
.start-btn {
  background: var(--color-brand);
  color: white;
  border: 2px solid var(--color-brand);
  border-radius: 8px;
  font-weight: 600;
  font-size: var(--text-md);
  padding: var(--space-4) var(--space-6);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  transition: background 0.15s ease, box-shadow 0.15s ease, transform 0.1s ease;
}
.start-btn:hover {
  background: var(--color-brand-dark);
  border-color: var(--color-brand-dark);
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.18);
}
.start-btn:active {
  transform: scale(0.98);
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

/* --- Quiz countdown row — bar + timer side by side --- */
.quiz-countdown-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-2);
}
.quiz-countdown-bar {
  flex: 1;
  height: 4px;
  background: var(--color-surface-alt);
  margin-left: calc(-1 * var(--space-5));
}
.quiz-countdown-fill {
  height: 100%;
  background: var(--color-brand);
  transition: width 0.2s linear;
  width: 100%;
}
.round-timer-warning .quiz-countdown-fill,
.last-question .quiz-countdown-fill {
  background: var(--color-error);
}
.quiz-info-time {
  font-size: var(--text-xs);
  font-variant-numeric: tabular-nums;
  color: var(--color-text-muted);
  white-space: nowrap;
}

/* --- Quiz session info — single compact row --- */
.quiz-session-info {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  padding: 0 var(--space-6) var(--space-2) 0;
}
.quiz-info-context {
  flex: 1;
}
.quiz-info-count {
  font-variant-numeric: tabular-nums;
}
.quiz-header-close {
  position: absolute;
  top: var(--space-3);
  right: 0;
  background: none;
  border: none;
  font-size: var(--text-xl);
  color: var(--color-text-light);
  cursor: pointer;
  padding: 0 var(--space-2);
  line-height: 1;
  margin: 0;
  border-radius: 4px;
  transition: color 0.15s ease, background 0.15s ease;
  z-index: 1;
}
.quiz-header-close:hover {
  color: var(--color-text);
  background: var(--color-surface-hover);
}

/* --- Progress bar --- */
.progress-bar {
  width: 100%;
  max-width: 300px;
  height: 20px;
  background: var(--color-surface-alt);
  border-radius: 10px;
  margin: 0 auto var(--space-4);
  overflow: hidden;
  position: relative;
}
.phase-active .progress-bar,
.phase-round-complete .progress-bar {
  display: none;
}
.progress-fill {
  height: 100%;
  background: var(--color-success);
  border-radius: 10px;
  transition: width 0.3s ease;
  min-width: 0;
}
.progress-text {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--color-text);
  pointer-events: none;
}

/* --- Quiz-active visual focus --- */
.phase-active,
.phase-round-complete,
.phase-calibration {
  background: var(--color-surface);
  margin: 0 calc(-1 * var(--space-5));
  padding: 0 var(--space-5);
}
.phase-active .quiz-area.active {
  border: 1px solid var(--color-border-lighter);
  padding: var(--space-3) var(--space-3);
}

/* --- Quiz area (subtle card containment) --- */
.quiz-area {
  display: none;
  text-align: center;
  margin: var(--space-5) 0;
  border: 2px solid transparent;
}
.quiz-area.active {
  display: block;
  background: var(--color-surface);
  border-radius: 12px;
  padding: var(--space-5);
}
/* --- Round complete --- */
.round-complete {
  text-align: center;
  padding: var(--space-6) 0;
}
.round-complete-context {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  margin-bottom: var(--space-4);
}
.round-complete-heading {
  font-size: var(--text-xl);
  font-weight: 700;
  color: var(--color-text);
  margin-bottom: var(--space-3);
}
.round-complete-stats {
  margin: var(--space-3) 0 var(--space-5);
}
.round-stat-line {
  font-size: var(--text-base);
  color: var(--color-text);
  line-height: 1.6;
}
.round-complete-actions {
  display: flex;
  gap: var(--space-3);
  justify-content: center;
}
.round-complete-continue {
  padding: var(--space-3) var(--space-5);
  background: var(--color-brand);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: var(--text-base);
  font-weight: 600;
  cursor: pointer;
}
.round-complete-continue:hover {
  opacity: 0.9;
}
.round-complete-continue:active {
  opacity: 0.8;
  transform: scale(0.98);
}
.round-complete-stop {
  padding: var(--space-3) var(--space-5);
  background: none;
  color: var(--color-text-muted);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  font-size: var(--text-base);
  cursor: pointer;
}
.round-complete-stop:hover {
  background: var(--color-surface-hover);
}
.round-complete-stop:active {
  background: var(--color-surface-pressed);
}
/* Hide quiz prompt, answer buttons, and feedback during round-complete */
.phase-round-complete .quiz-prompt-row,
.phase-round-complete .answer-buttons,
.phase-round-complete .note-buttons,
.phase-round-complete .chord-slots,
.phase-round-complete .feedback,
.phase-round-complete .hint,
.phase-round-complete .time-display,
.phase-round-complete .speed-tap-status,
.phase-round-complete .fretboard-wrapper,
.phase-round-complete .quiz-countdown-row,
.phase-round-complete .quiz-session-info,
.phase-round-complete .quiz-header-close {
  display: none;
}

/* --- Note buttons (piano-style layout) --- */
.note-buttons {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  margin: var(--space-3) auto;
}
.note-row-naturals,
.note-row-accidentals {
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  column-gap: 2px; /* sub-column separator; --space-1 too wide for 14-col grid */
}
.note-row-accidentals.hidden {
  display: none;
}
/* Natural notes: each spans 2 of 14 sub-columns */
.note-row-naturals .note-btn:nth-child(1) {
  grid-column: 1 / 3;
}
.note-row-naturals .note-btn:nth-child(2) {
  grid-column: 3 / 5;
}
.note-row-naturals .note-btn:nth-child(3) {
  grid-column: 5 / 7;
}
.note-row-naturals .note-btn:nth-child(4) {
  grid-column: 7 / 9;
}
.note-row-naturals .note-btn:nth-child(5) {
  grid-column: 9 / 11;
}
.note-row-naturals .note-btn:nth-child(6) {
  grid-column: 11 / 13;
}
.note-row-naturals .note-btn:nth-child(7) {
  grid-column: 13 / 15;
}
/* Accidentals: piano black-key positioning between naturals */
.note-row-accidentals .note-btn:nth-child(1) {
  grid-column: 2 / 4;
}
.note-row-accidentals .note-btn:nth-child(2) {
  grid-column: 4 / 6;
}
.note-row-accidentals .note-btn:nth-child(3) {
  grid-column: 8 / 10;
}
.note-row-accidentals .note-btn:nth-child(4) {
  grid-column: 10 / 12;
}
.note-row-accidentals .note-btn:nth-child(5) {
  grid-column: 12 / 14;
}
.note-btn {
  min-width: 0;
  height: 48px;
  font-size: var(--text-md);
  font-weight: 500;
  border: 2px solid var(--color-text-muted);
  border-radius: 8px;
  background: var(--color-bg);
  cursor: pointer;
  padding: 0;
  touch-action: manipulation;
  transition:
    background 0.15s ease,
    border-color 0.15s ease,
    transform 0.1s ease;
}
.note-btn:hover {
  background: var(--color-surface-hover);
  border-color: var(--color-text);
}
.note-btn.accidental {
  background: var(--color-surface-accent);
}
.note-btn.accidental:hover {
  background: var(--color-surface-pressed);
}
.note-btn:active {
  background: var(--color-surface-pressed);
  transform: scale(0.97);
}
.note-btn:disabled {
  opacity: 0.5;
  cursor: default;
}
.note-btn:disabled:hover {
  background: var(--color-bg);
  border-color: var(--color-text-muted);
  transform: none;
}
.note-btn.hidden {
  display: none;
}

/* --- Quiz prompt (text modes) --- */
.quiz-prompt-row {
  display: flex;
  align-items: baseline;
  justify-content: center;
  gap: var(--space-2);
  margin: var(--space-5) 0;
  min-height: 2.5rem;
}
.quiz-prompt {
  font-size: var(--text-2xl);
  font-weight: 600;
}
.quiz-prompt:empty {
  display: none;
}
.quiz-last-question {
  font-size: var(--text-sm);
  color: var(--color-error);
  font-weight: 500;
}
.quiz-last-question:empty {
  display: none;
}

/* --- Answer buttons grid (shared by new modes) --- */
.answer-buttons {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.4rem;
  max-width: 360px;
  margin: var(--space-3) auto;
}
.answer-btn {
  height: 48px;
  font-size: var(--text-md);
  font-weight: 500;
  border: 2px solid var(--color-text-muted);
  border-radius: 8px;
  background: var(--color-bg);
  cursor: pointer;
  padding: 0 var(--space-2);
  touch-action: manipulation;
  transition:
    background 0.15s ease,
    border-color 0.15s ease,
    transform 0.1s ease;
}
.answer-btn:hover {
  background: var(--color-surface-hover);
  border-color: var(--color-text);
}
.answer-btn:active {
  background: var(--color-surface-pressed);
  transform: scale(0.97);
}
.answer-btn:disabled {
  opacity: 0.5;
  cursor: default;
}
.answer-btn:disabled:hover {
  background: var(--color-bg);
  border-color: var(--color-text-muted);
  transform: none;
}
.answer-buttons-intervals {
  grid-template-columns: repeat(3, 1fr);
}

/* --- Answer group visibility (toggled by mode JS for bidirectional questions) --- */
.answer-group-hidden {
  display: none;
}

/* --- Calibration overlay: inside quiz-area, hide non-calibration content --- */
.phase-calibration .answer-buttons:not(.calibration-active),
.phase-calibration .note-buttons:not(.calibration-active) {
  display: none;
}
.phase-calibration .answer-buttons.calibration-active {
  display: grid;
}
.phase-calibration .note-buttons.calibration-active {
  display: flex;
}
.phase-calibration .speed-tap-status,
.phase-calibration .fretboard-wrapper {
  display: none;
}
.phase-calibration .chord-slots {
  display: none;
}
/* Calibration: hide quiz info (progress bar shows trial count instead) */
.phase-calibration .quiz-session-info {
  display: none;
}
/* Intro + results: hide buttons and progress */
.phase-calibration.calibration-intro .calibration-active,
.phase-calibration.calibration-results .calibration-active {
  display: none;
}
.phase-calibration.calibration-intro .progress-bar,
.phase-calibration.calibration-results .progress-bar {
  display: none;
}

/* --- Calibration highlight --- */
.calibration-target {
  background: var(--color-success) !important;
  border-color: var(--color-success-dark) !important;
  color: white !important;
  box-shadow: 0 0 12px rgba(76, 175, 80, 0.6);
}
.calibration-progress {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  margin-top: var(--space-3);
}
.calibration-action-btn {
  display: block;
  margin: var(--space-6) auto 0;
  padding: var(--space-4) 2.5rem;
  font-size: var(--text-md);
  font-weight: 600;
  background: var(--color-brand);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.15s ease;
}
.calibration-action-btn:hover {
  background: var(--color-brand-dark);
}
.calibration-action-btn:active {
  background: var(--color-brand-dark);
}
.calibration-results {
  text-align: center;
  margin: var(--space-5) auto;
  max-width: 420px;
}
.calibration-baseline {
  font-size: var(--text-md);
  font-weight: 600;
  margin: var(--space-3) 0 var(--space-5);
}
.calibration-thresholds {
  border-collapse: collapse;
  margin: 0 auto var(--space-5);
  font-size: var(--text-sm);
  width: 100%;
}
.calibration-thresholds th,
.calibration-thresholds td {
  border: 1px solid var(--color-border-light);
  padding: 0.35rem var(--space-3);
  text-align: left;
}
.calibration-thresholds th {
  background: var(--color-surface);
  font-weight: 600;
}
.calibration-thresholds td:first-child {
  font-weight: 600;
  white-space: nowrap;
}
.calibration-thresholds td:nth-child(2) {
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
}

/* --- Feedback --- */
.feedback {
  font-size: var(--text-xl);
  margin: var(--space-5) 0;
  min-height: 2rem;
}
.correct {
  color: var(--color-success);
}
.incorrect {
  color: var(--color-error);
}
.time-display {
  color: var(--color-text-muted);
  font-size: var(--text-sm);
  margin-top: var(--space-3);
}
.hint {
  color: var(--color-text-muted);
  font-size: var(--text-base);
  margin-top: var(--space-5);
}
.stats {
  margin-top: var(--space-5);
  font-size: var(--text-sm);
  color: var(--color-text-muted);
}

/* --- Heatmap legends --- */
.heatmap-legend {
  display: none;
  justify-content: center;
  gap: var(--space-3);
  flex-wrap: wrap;
  margin: var(--space-4) 0;
}
.heatmap-legend.active {
  display: flex;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 0.2rem;
  font-size: var(--text-xs);
  color: var(--color-text-muted);
}
.legend-swatch {
  width: 12px;
  height: 12px;
  border-radius: 3px;
  border: 1px solid var(--color-border);
}
.setting-group {
  display: flex;
  align-items: center;
  gap: 0.3rem;
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  cursor: pointer;
}
.toggle-group {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-1);
}
.toggle-group-label {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  font-weight: 500;
}

/* --- Stats tables (lookup modes) --- */
.stats-container {
  text-align: center;
  margin: var(--space-3) 0;
}
.stats-table {
  border-collapse: collapse;
  margin: var(--space-3) auto;
  font-size: var(--text-sm);
}
.stats-table th, .stats-table td {
  border: 1px solid var(--color-border-light);
  padding: 0.4rem 0.7rem;
  text-align: center;
}
.stats-table th {
  background: var(--color-surface);
  font-weight: 600;
}
.stats-cell {
  width: 40px;
  height: 28px;
  border-radius: 4px;
  padding: 0;
  box-sizing: border-box;
}

/* --- Stats grids (math modes) --- */
.stats-grid-wrapper {
  overflow-x: auto;
  margin: var(--space-3) 0;
}
.stats-grid {
  border-collapse: collapse;
  margin: 0 auto;
  font-size: var(--text-sm);
}
.stats-grid th, .stats-grid td {
  border: 1px solid var(--color-border-light);
  padding: 0.2rem 0.3rem;
  text-align: center;
}
.stats-grid th {
  background: var(--color-surface);
  font-weight: 600;
  font-size: var(--text-xs);
}
.stats-grid .stats-cell {
  width: 30px;
  height: 24px;
}
.stats-grid-row-label {
  font-weight: 600;
  background: var(--color-surface);
  padding: 0.2rem 0.4rem;
}

/* --- Speed Tap mode --- */
.speed-tap-status {
  display: flex;
  justify-content: center;
  gap: var(--space-6);
  font-size: var(--text-lg);
  margin: var(--space-3) 0;
}
.speed-tap-progress {
  font-weight: 500;
}
.speed-tap-stats {
  font-size: var(--text-xs);
}
.speed-tap-stats th, .speed-tap-stats td {
  padding: 0.2rem 0.3rem;
}
.speed-tap-stats .stats-cell {
  width: 24px;
  height: 20px;
}

/* --- Stats controls (toggle above chart) --- */
.stats-controls {
  text-align: center;
  margin: var(--space-3) 0;
  padding-bottom: var(--space-2);
}

/* --- Stats mode toggle (Recall / Speed) --- */
.stats-toggle {
  display: inline-flex;
  border: 2px solid var(--color-border);
  border-radius: 6px;
  overflow: hidden;
}
.stats-toggle-btn {
  padding: 0.35rem var(--space-5);
  font-size: var(--text-sm);
  font-weight: 500;
  border: none;
  border-radius: 0;
  background: var(--color-bg);
  color: var(--color-text-muted);
  cursor: pointer;
  margin: 0;
  transition: background 0.15s ease, color 0.15s ease;
}
.stats-toggle-btn + .stats-toggle-btn {
  border-left: 1px solid var(--color-border-light);
}
.stats-toggle-btn.active {
  background: var(--color-brand);
  color: white;
}
.stats-toggle-btn:not(.active):hover {
  background: var(--color-surface-hover);
}

/* --- Key signature answer buttons --- */
.answer-buttons-keysig {
  grid-template-columns: repeat(4, 1fr);
}

/* --- Degree answer buttons --- */
.answer-buttons-degrees {
  grid-template-columns: repeat(4, 1fr);
}

/* --- Roman numeral answer buttons --- */
.answer-buttons-numerals {
  grid-template-columns: repeat(4, 1fr);
}

/* --- Chord spelling slots --- */
.chord-slots {
  display: flex;
  justify-content: center;
  gap: var(--space-3);
  margin: var(--space-4) 0;
  min-height: 2.5rem;
}
.chord-slot {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 3rem;
  height: 2.5rem;
  border: 2px solid var(--color-border);
  border-radius: 6px;
  font-size: var(--text-md);
  font-weight: 600;
  background: var(--color-surface);
  transition: border-color 0.15s ease, background 0.15s ease;
}
.chord-slot.active {
  border-color: var(--color-focus);
  background: var(--color-focus-bg);
}
.chord-slot.correct {
  border-color: var(--color-success);
  background: var(--color-success-bg);
  color: var(--color-success-text);
}
.chord-slot.wrong {
  border-color: var(--color-error);
  background: var(--color-error-bg);
  color: var(--color-error-text);
}

/* --- Focus-visible (keyboard navigation) --- */
:focus-visible {
  outline: 2px solid var(--color-brand);
  outline-offset: 2px;
}
/* Remove default outline for mouse/touch users */
:focus:not(:focus-visible) {
  outline: none;
}
/* Specific overrides for elements that need different focus styling */
.start-btn:focus-visible {
  outline-color: var(--color-brand-dark);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12), 0 0 0 4px rgba(209, 147, 27, 0.3);
}
.home-mode-btn:focus-visible {
  outline-offset: -2px;
}

/* --- Reduced motion --- */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Mobile layout */
@media (max-width: 599px) {
  body {
    margin: 0;
    padding: 0 var(--space-1);
    padding-top: env(safe-area-inset-top, 0);
    padding-bottom: env(safe-area-inset-bottom, 0);
    padding-left: max(var(--space-1), env(safe-area-inset-left, 0));
    padding-right: max(var(--space-1), env(safe-area-inset-right, 0));
    border-left: none;
    border-right: none;
  }

  .quiz-countdown-bar {
    margin-left: calc(-1 * var(--space-1));
  }

  .phase-active,
  .phase-round-complete,
  .phase-calibration {
    margin: 0 calc(-1 * var(--space-1));
    padding: 0 var(--space-1);
  }

  .fretboard-container {
    width: 100%;
    max-width: none;
  }

  .answer-buttons {
    grid-template-columns: repeat(3, 1fr);
    max-width: 280px;
  }

  .quiz-prompt {
    font-size: 1.6rem;
  }

  /* Prevent iOS zoom on input focus */
  input, button {
    font-size: 16px;
  }
}

  </style>
  <style>
    /* Preview page overrides */
    body {
      display: block;
      max-width: 720px;
      padding: 2rem 1rem;
      min-height: auto;
      color: var(--color-text);
      line-height: 1.5;
    }
    h1 { font-size: 1.5rem; margin: 0 0 0.25rem; }
    .subtitle { color: var(--color-text-muted); font-size: 0.9rem; margin-bottom: 2rem; }
    .page-nav { display: flex; gap: 1rem; margin-bottom: 1rem; font-size: 0.8rem; }
    .page-nav a { color: var(--color-brand-dark); text-decoration: none; }
    .page-nav a:hover { text-decoration: underline; }
    h2 {
      font-size: 1.1rem;
      margin: 2.5rem 0 0.75rem;
      padding-bottom: 0.25rem;
      border-bottom: 1px solid var(--color-border-lighter);
    }
    .preview-section { margin-bottom: 1.5rem; }
    .preview-section h3 {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--color-text-light);
      margin: 0 0 0.5rem;
    }
    .preview-frame {
      max-width: 402px;
      border: 1px solid var(--color-border-light);
      border-radius: 8px;
      padding: var(--space-4);
      background: var(--color-bg);
    }
  </style>
</head>
<body>
  <h1>Component Preview</h1>
  <div class="subtitle">
    Preact components rendered with mock data &mdash; edit
    <code>src/ui/preview.tsx</code>, rebuild or refresh <code>/preview</code>.
  </div>
  <div class="page-nav">
    <a href="moments.html">Moments &rarr;</a>
    <a href="components.html">Design System &rarr;</a>
    <a href="colors.html">Colors &rarr;</a>
  </div>
  <div id="preview-root"></div>
  <script>
(() => {
  // node_modules/preact/dist/preact.module.js
  var n;
  var l;
  var u;
  var t;
  var i;
  var r;
  var o;
  var e;
  var f;
  var c;
  var s;
  var a;
  var h;
  var p = {};
  var v = [];
  var y = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;
  var d = Array.isArray;
  function w(n2, l2) {
    for (var u3 in l2) n2[u3] = l2[u3];
    return n2;
  }
  function g(n2) {
    n2 && n2.parentNode && n2.parentNode.removeChild(n2);
  }
  function _(l2, u3, t2) {
    var i2, r2, o2, e2 = {};
    for (o2 in u3) "key" == o2 ? i2 = u3[o2] : "ref" == o2 ? r2 = u3[o2] : e2[o2] = u3[o2];
    if (arguments.length > 2 && (e2.children = arguments.length > 3 ? n.call(arguments, 2) : t2), "function" == typeof l2 && null != l2.defaultProps) for (o2 in l2.defaultProps) void 0 === e2[o2] && (e2[o2] = l2.defaultProps[o2]);
    return m(l2, e2, i2, r2, null);
  }
  function m(n2, t2, i2, r2, o2) {
    var e2 = { type: n2, props: t2, key: i2, ref: r2, __k: null, __: null, __b: 0, __e: null, __c: null, constructor: void 0, __v: null == o2 ? ++u : o2, __i: -1, __u: 0 };
    return null == o2 && null != l.vnode && l.vnode(e2), e2;
  }
  function k(n2) {
    return n2.children;
  }
  function x(n2, l2) {
    this.props = n2, this.context = l2;
  }
  function S(n2, l2) {
    if (null == l2) return n2.__ ? S(n2.__, n2.__i + 1) : null;
    for (var u3; l2 < n2.__k.length; l2++) if (null != (u3 = n2.__k[l2]) && null != u3.__e) return u3.__e;
    return "function" == typeof n2.type ? S(n2) : null;
  }
  function C(n2) {
    if (n2.__P && n2.__d) {
      var u3 = n2.__v, t2 = u3.__e, i2 = [], r2 = [], o2 = w({}, u3);
      o2.__v = u3.__v + 1, l.vnode && l.vnode(o2), z(n2.__P, o2, u3, n2.__n, n2.__P.namespaceURI, 32 & u3.__u ? [t2] : null, i2, null == t2 ? S(u3) : t2, !!(32 & u3.__u), r2), o2.__v = u3.__v, o2.__.__k[o2.__i] = o2, V(i2, o2, r2), u3.__e = u3.__ = null, o2.__e != t2 && M(o2);
    }
  }
  function M(n2) {
    if (null != (n2 = n2.__) && null != n2.__c) return n2.__e = n2.__c.base = null, n2.__k.some(function(l2) {
      if (null != l2 && null != l2.__e) return n2.__e = n2.__c.base = l2.__e;
    }), M(n2);
  }
  function $(n2) {
    (!n2.__d && (n2.__d = true) && i.push(n2) && !I.__r++ || r != l.debounceRendering) && ((r = l.debounceRendering) || o)(I);
  }
  function I() {
    for (var n2, l2 = 1; i.length; ) i.length > l2 && i.sort(e), n2 = i.shift(), l2 = i.length, C(n2);
    I.__r = 0;
  }
  function P(n2, l2, u3, t2, i2, r2, o2, e2, f3, c2, s2) {
    var a2, h2, y2, d2, w2, g2, _2, m2 = t2 && t2.__k || v, b = l2.length;
    for (f3 = A(u3, l2, m2, f3, b), a2 = 0; a2 < b; a2++) null != (y2 = u3.__k[a2]) && (h2 = -1 != y2.__i && m2[y2.__i] || p, y2.__i = a2, g2 = z(n2, y2, h2, i2, r2, o2, e2, f3, c2, s2), d2 = y2.__e, y2.ref && h2.ref != y2.ref && (h2.ref && D(h2.ref, null, y2), s2.push(y2.ref, y2.__c || d2, y2)), null == w2 && null != d2 && (w2 = d2), (_2 = !!(4 & y2.__u)) || h2.__k === y2.__k ? f3 = H(y2, f3, n2, _2) : "function" == typeof y2.type && void 0 !== g2 ? f3 = g2 : d2 && (f3 = d2.nextSibling), y2.__u &= -7);
    return u3.__e = w2, f3;
  }
  function A(n2, l2, u3, t2, i2) {
    var r2, o2, e2, f3, c2, s2 = u3.length, a2 = s2, h2 = 0;
    for (n2.__k = new Array(i2), r2 = 0; r2 < i2; r2++) null != (o2 = l2[r2]) && "boolean" != typeof o2 && "function" != typeof o2 ? ("string" == typeof o2 || "number" == typeof o2 || "bigint" == typeof o2 || o2.constructor == String ? o2 = n2.__k[r2] = m(null, o2, null, null, null) : d(o2) ? o2 = n2.__k[r2] = m(k, { children: o2 }, null, null, null) : void 0 === o2.constructor && o2.__b > 0 ? o2 = n2.__k[r2] = m(o2.type, o2.props, o2.key, o2.ref ? o2.ref : null, o2.__v) : n2.__k[r2] = o2, f3 = r2 + h2, o2.__ = n2, o2.__b = n2.__b + 1, e2 = null, -1 != (c2 = o2.__i = T(o2, u3, f3, a2)) && (a2--, (e2 = u3[c2]) && (e2.__u |= 2)), null == e2 || null == e2.__v ? (-1 == c2 && (i2 > s2 ? h2-- : i2 < s2 && h2++), "function" != typeof o2.type && (o2.__u |= 4)) : c2 != f3 && (c2 == f3 - 1 ? h2-- : c2 == f3 + 1 ? h2++ : (c2 > f3 ? h2-- : h2++, o2.__u |= 4))) : n2.__k[r2] = null;
    if (a2) for (r2 = 0; r2 < s2; r2++) null != (e2 = u3[r2]) && 0 == (2 & e2.__u) && (e2.__e == t2 && (t2 = S(e2)), E(e2, e2));
    return t2;
  }
  function H(n2, l2, u3, t2) {
    var i2, r2;
    if ("function" == typeof n2.type) {
      for (i2 = n2.__k, r2 = 0; i2 && r2 < i2.length; r2++) i2[r2] && (i2[r2].__ = n2, l2 = H(i2[r2], l2, u3, t2));
      return l2;
    }
    n2.__e != l2 && (t2 && (l2 && n2.type && !l2.parentNode && (l2 = S(n2)), u3.insertBefore(n2.__e, l2 || null)), l2 = n2.__e);
    do {
      l2 = l2 && l2.nextSibling;
    } while (null != l2 && 8 == l2.nodeType);
    return l2;
  }
  function T(n2, l2, u3, t2) {
    var i2, r2, o2, e2 = n2.key, f3 = n2.type, c2 = l2[u3], s2 = null != c2 && 0 == (2 & c2.__u);
    if (null === c2 && null == e2 || s2 && e2 == c2.key && f3 == c2.type) return u3;
    if (t2 > (s2 ? 1 : 0)) {
      for (i2 = u3 - 1, r2 = u3 + 1; i2 >= 0 || r2 < l2.length; ) if (null != (c2 = l2[o2 = i2 >= 0 ? i2-- : r2++]) && 0 == (2 & c2.__u) && e2 == c2.key && f3 == c2.type) return o2;
    }
    return -1;
  }
  function j(n2, l2, u3) {
    "-" == l2[0] ? n2.setProperty(l2, null == u3 ? "" : u3) : n2[l2] = null == u3 ? "" : "number" != typeof u3 || y.test(l2) ? u3 : u3 + "px";
  }
  function F(n2, l2, u3, t2, i2) {
    var r2, o2;
    n: if ("style" == l2) if ("string" == typeof u3) n2.style.cssText = u3;
    else {
      if ("string" == typeof t2 && (n2.style.cssText = t2 = ""), t2) for (l2 in t2) u3 && l2 in u3 || j(n2.style, l2, "");
      if (u3) for (l2 in u3) t2 && u3[l2] == t2[l2] || j(n2.style, l2, u3[l2]);
    }
    else if ("o" == l2[0] && "n" == l2[1]) r2 = l2 != (l2 = l2.replace(f, "$1")), o2 = l2.toLowerCase(), l2 = o2 in n2 || "onFocusOut" == l2 || "onFocusIn" == l2 ? o2.slice(2) : l2.slice(2), n2.l || (n2.l = {}), n2.l[l2 + r2] = u3, u3 ? t2 ? u3.u = t2.u : (u3.u = c, n2.addEventListener(l2, r2 ? a : s, r2)) : n2.removeEventListener(l2, r2 ? a : s, r2);
    else {
      if ("http://www.w3.org/2000/svg" == i2) l2 = l2.replace(/xlink(H|:h)/, "h").replace(/sName$/, "s");
      else if ("width" != l2 && "height" != l2 && "href" != l2 && "list" != l2 && "form" != l2 && "tabIndex" != l2 && "download" != l2 && "rowSpan" != l2 && "colSpan" != l2 && "role" != l2 && "popover" != l2 && l2 in n2) try {
        n2[l2] = null == u3 ? "" : u3;
        break n;
      } catch (n3) {
      }
      "function" == typeof u3 || (null == u3 || false === u3 && "-" != l2[4] ? n2.removeAttribute(l2) : n2.setAttribute(l2, "popover" == l2 && 1 == u3 ? "" : u3));
    }
  }
  function O(n2) {
    return function(u3) {
      if (this.l) {
        var t2 = this.l[u3.type + n2];
        if (null == u3.t) u3.t = c++;
        else if (u3.t < t2.u) return;
        return t2(l.event ? l.event(u3) : u3);
      }
    };
  }
  function z(n2, u3, t2, i2, r2, o2, e2, f3, c2, s2) {
    var a2, h2, p2, y2, _2, m2, b, S2, C2, M2, $2, I2, A2, H2, L, T2 = u3.type;
    if (void 0 !== u3.constructor) return null;
    128 & t2.__u && (c2 = !!(32 & t2.__u), o2 = [f3 = u3.__e = t2.__e]), (a2 = l.__b) && a2(u3);
    n: if ("function" == typeof T2) try {
      if (S2 = u3.props, C2 = "prototype" in T2 && T2.prototype.render, M2 = (a2 = T2.contextType) && i2[a2.__c], $2 = a2 ? M2 ? M2.props.value : a2.__ : i2, t2.__c ? b = (h2 = u3.__c = t2.__c).__ = h2.__E : (C2 ? u3.__c = h2 = new T2(S2, $2) : (u3.__c = h2 = new x(S2, $2), h2.constructor = T2, h2.render = G), M2 && M2.sub(h2), h2.state || (h2.state = {}), h2.__n = i2, p2 = h2.__d = true, h2.__h = [], h2._sb = []), C2 && null == h2.__s && (h2.__s = h2.state), C2 && null != T2.getDerivedStateFromProps && (h2.__s == h2.state && (h2.__s = w({}, h2.__s)), w(h2.__s, T2.getDerivedStateFromProps(S2, h2.__s))), y2 = h2.props, _2 = h2.state, h2.__v = u3, p2) C2 && null == T2.getDerivedStateFromProps && null != h2.componentWillMount && h2.componentWillMount(), C2 && null != h2.componentDidMount && h2.__h.push(h2.componentDidMount);
      else {
        if (C2 && null == T2.getDerivedStateFromProps && S2 !== y2 && null != h2.componentWillReceiveProps && h2.componentWillReceiveProps(S2, $2), u3.__v == t2.__v || !h2.__e && null != h2.shouldComponentUpdate && false === h2.shouldComponentUpdate(S2, h2.__s, $2)) {
          u3.__v != t2.__v && (h2.props = S2, h2.state = h2.__s, h2.__d = false), u3.__e = t2.__e, u3.__k = t2.__k, u3.__k.some(function(n3) {
            n3 && (n3.__ = u3);
          }), v.push.apply(h2.__h, h2._sb), h2._sb = [], h2.__h.length && e2.push(h2);
          break n;
        }
        null != h2.componentWillUpdate && h2.componentWillUpdate(S2, h2.__s, $2), C2 && null != h2.componentDidUpdate && h2.__h.push(function() {
          h2.componentDidUpdate(y2, _2, m2);
        });
      }
      if (h2.context = $2, h2.props = S2, h2.__P = n2, h2.__e = false, I2 = l.__r, A2 = 0, C2) h2.state = h2.__s, h2.__d = false, I2 && I2(u3), a2 = h2.render(h2.props, h2.state, h2.context), v.push.apply(h2.__h, h2._sb), h2._sb = [];
      else do {
        h2.__d = false, I2 && I2(u3), a2 = h2.render(h2.props, h2.state, h2.context), h2.state = h2.__s;
      } while (h2.__d && ++A2 < 25);
      h2.state = h2.__s, null != h2.getChildContext && (i2 = w(w({}, i2), h2.getChildContext())), C2 && !p2 && null != h2.getSnapshotBeforeUpdate && (m2 = h2.getSnapshotBeforeUpdate(y2, _2)), H2 = null != a2 && a2.type === k && null == a2.key ? q(a2.props.children) : a2, f3 = P(n2, d(H2) ? H2 : [H2], u3, t2, i2, r2, o2, e2, f3, c2, s2), h2.base = u3.__e, u3.__u &= -161, h2.__h.length && e2.push(h2), b && (h2.__E = h2.__ = null);
    } catch (n3) {
      if (u3.__v = null, c2 || null != o2) if (n3.then) {
        for (u3.__u |= c2 ? 160 : 128; f3 && 8 == f3.nodeType && f3.nextSibling; ) f3 = f3.nextSibling;
        o2[o2.indexOf(f3)] = null, u3.__e = f3;
      } else {
        for (L = o2.length; L--; ) g(o2[L]);
        N(u3);
      }
      else u3.__e = t2.__e, u3.__k = t2.__k, n3.then || N(u3);
      l.__e(n3, u3, t2);
    }
    else null == o2 && u3.__v == t2.__v ? (u3.__k = t2.__k, u3.__e = t2.__e) : f3 = u3.__e = B(t2.__e, u3, t2, i2, r2, o2, e2, c2, s2);
    return (a2 = l.diffed) && a2(u3), 128 & u3.__u ? void 0 : f3;
  }
  function N(n2) {
    n2 && (n2.__c && (n2.__c.__e = true), n2.__k && n2.__k.some(N));
  }
  function V(n2, u3, t2) {
    for (var i2 = 0; i2 < t2.length; i2++) D(t2[i2], t2[++i2], t2[++i2]);
    l.__c && l.__c(u3, n2), n2.some(function(u4) {
      try {
        n2 = u4.__h, u4.__h = [], n2.some(function(n3) {
          n3.call(u4);
        });
      } catch (n3) {
        l.__e(n3, u4.__v);
      }
    });
  }
  function q(n2) {
    return "object" != typeof n2 || null == n2 || n2.__b > 0 ? n2 : d(n2) ? n2.map(q) : w({}, n2);
  }
  function B(u3, t2, i2, r2, o2, e2, f3, c2, s2) {
    var a2, h2, v2, y2, w2, _2, m2, b = i2.props || p, k2 = t2.props, x2 = t2.type;
    if ("svg" == x2 ? o2 = "http://www.w3.org/2000/svg" : "math" == x2 ? o2 = "http://www.w3.org/1998/Math/MathML" : o2 || (o2 = "http://www.w3.org/1999/xhtml"), null != e2) {
      for (a2 = 0; a2 < e2.length; a2++) if ((w2 = e2[a2]) && "setAttribute" in w2 == !!x2 && (x2 ? w2.localName == x2 : 3 == w2.nodeType)) {
        u3 = w2, e2[a2] = null;
        break;
      }
    }
    if (null == u3) {
      if (null == x2) return document.createTextNode(k2);
      u3 = document.createElementNS(o2, x2, k2.is && k2), c2 && (l.__m && l.__m(t2, e2), c2 = false), e2 = null;
    }
    if (null == x2) b === k2 || c2 && u3.data == k2 || (u3.data = k2);
    else {
      if (e2 = e2 && n.call(u3.childNodes), !c2 && null != e2) for (b = {}, a2 = 0; a2 < u3.attributes.length; a2++) b[(w2 = u3.attributes[a2]).name] = w2.value;
      for (a2 in b) w2 = b[a2], "dangerouslySetInnerHTML" == a2 ? v2 = w2 : "children" == a2 || a2 in k2 || "value" == a2 && "defaultValue" in k2 || "checked" == a2 && "defaultChecked" in k2 || F(u3, a2, null, w2, o2);
      for (a2 in k2) w2 = k2[a2], "children" == a2 ? y2 = w2 : "dangerouslySetInnerHTML" == a2 ? h2 = w2 : "value" == a2 ? _2 = w2 : "checked" == a2 ? m2 = w2 : c2 && "function" != typeof w2 || b[a2] === w2 || F(u3, a2, w2, b[a2], o2);
      if (h2) c2 || v2 && (h2.__html == v2.__html || h2.__html == u3.innerHTML) || (u3.innerHTML = h2.__html), t2.__k = [];
      else if (v2 && (u3.innerHTML = ""), P("template" == t2.type ? u3.content : u3, d(y2) ? y2 : [y2], t2, i2, r2, "foreignObject" == x2 ? "http://www.w3.org/1999/xhtml" : o2, e2, f3, e2 ? e2[0] : i2.__k && S(i2, 0), c2, s2), null != e2) for (a2 = e2.length; a2--; ) g(e2[a2]);
      c2 || (a2 = "value", "progress" == x2 && null == _2 ? u3.removeAttribute("value") : null != _2 && (_2 !== u3[a2] || "progress" == x2 && !_2 || "option" == x2 && _2 != b[a2]) && F(u3, a2, _2, b[a2], o2), a2 = "checked", null != m2 && m2 != u3[a2] && F(u3, a2, m2, b[a2], o2));
    }
    return u3;
  }
  function D(n2, u3, t2) {
    try {
      if ("function" == typeof n2) {
        var i2 = "function" == typeof n2.__u;
        i2 && n2.__u(), i2 && null == u3 || (n2.__u = n2(u3));
      } else n2.current = u3;
    } catch (n3) {
      l.__e(n3, t2);
    }
  }
  function E(n2, u3, t2) {
    var i2, r2;
    if (l.unmount && l.unmount(n2), (i2 = n2.ref) && (i2.current && i2.current != n2.__e || D(i2, null, u3)), null != (i2 = n2.__c)) {
      if (i2.componentWillUnmount) try {
        i2.componentWillUnmount();
      } catch (n3) {
        l.__e(n3, u3);
      }
      i2.base = i2.__P = null;
    }
    if (i2 = n2.__k) for (r2 = 0; r2 < i2.length; r2++) i2[r2] && E(i2[r2], u3, t2 || "function" != typeof n2.type);
    t2 || g(n2.__e), n2.__c = n2.__ = n2.__e = void 0;
  }
  function G(n2, l2, u3) {
    return this.constructor(n2, u3);
  }
  function J(u3, t2, i2) {
    var r2, o2, e2, f3;
    t2 == document && (t2 = document.documentElement), l.__ && l.__(u3, t2), o2 = (r2 = "function" == typeof i2) ? null : i2 && i2.__k || t2.__k, e2 = [], f3 = [], z(t2, u3 = (!r2 && i2 || t2).__k = _(k, null, [u3]), o2 || p, p, t2.namespaceURI, !r2 && i2 ? [i2] : o2 ? null : t2.firstChild ? n.call(t2.childNodes) : null, e2, !r2 && i2 ? i2 : o2 ? o2.__e : t2.firstChild, r2, f3), V(e2, u3, f3);
  }
  n = v.slice, l = { __e: function(n2, l2, u3, t2) {
    for (var i2, r2, o2; l2 = l2.__; ) if ((i2 = l2.__c) && !i2.__) try {
      if ((r2 = i2.constructor) && null != r2.getDerivedStateFromError && (i2.setState(r2.getDerivedStateFromError(n2)), o2 = i2.__d), null != i2.componentDidCatch && (i2.componentDidCatch(n2, t2 || {}), o2 = i2.__d), o2) return i2.__E = i2;
    } catch (l3) {
      n2 = l3;
    }
    throw n2;
  } }, u = 0, t = function(n2) {
    return null != n2 && void 0 === n2.constructor;
  }, x.prototype.setState = function(n2, l2) {
    var u3;
    u3 = null != this.__s && this.__s != this.state ? this.__s : this.__s = w({}, this.state), "function" == typeof n2 && (n2 = n2(w({}, u3), this.props)), n2 && w(u3, n2), null != n2 && this.__v && (l2 && this._sb.push(l2), $(this));
  }, x.prototype.forceUpdate = function(n2) {
    this.__v && (this.__e = true, n2 && this.__h.push(n2), $(this));
  }, x.prototype.render = k, i = [], o = "function" == typeof Promise ? Promise.prototype.then.bind(Promise.resolve()) : setTimeout, e = function(n2, l2) {
    return n2.__v.__b - l2.__v.__b;
  }, I.__r = 0, f = /(PointerCapture)$|Capture$/i, c = 0, s = O(false), a = O(true), h = 0;

  // src/music-data.ts
  var NOTES = [
    { name: "C", displayName: "C", num: 0, accepts: ["c"] },
    { name: "C#", displayName: "C#/Db", num: 1, accepts: ["c#", "db"] },
    { name: "D", displayName: "D", num: 2, accepts: ["d"] },
    { name: "D#", displayName: "D#/Eb", num: 3, accepts: ["d#", "eb"] },
    { name: "E", displayName: "E", num: 4, accepts: ["e"] },
    { name: "F", displayName: "F", num: 5, accepts: ["f"] },
    { name: "F#", displayName: "F#/Gb", num: 6, accepts: ["f#", "gb"] },
    { name: "G", displayName: "G", num: 7, accepts: ["g"] },
    { name: "G#", displayName: "G#/Ab", num: 8, accepts: ["g#", "ab"] },
    { name: "A", displayName: "A", num: 9, accepts: ["a"] },
    { name: "A#", displayName: "A#/Bb", num: 10, accepts: ["a#", "bb"] },
    { name: "B", displayName: "B", num: 11, accepts: ["b"] }
  ];
  var DIATONIC_CHORDS = [
    { degree: 1, numeral: "I", quality: "major", qualityLabel: "" },
    { degree: 2, numeral: "ii", quality: "minor", qualityLabel: "m" },
    { degree: 3, numeral: "iii", quality: "minor", qualityLabel: "m" },
    { degree: 4, numeral: "IV", quality: "major", qualityLabel: "" },
    { degree: 5, numeral: "V", quality: "major", qualityLabel: "" },
    { degree: 6, numeral: "vi", quality: "minor", qualityLabel: "m" },
    {
      degree: 7,
      numeral: "vii\xB0",
      quality: "diminished",
      qualityLabel: "dim"
    }
  ];
  var ROMAN_NUMERALS = DIATONIC_CHORDS.map((c2) => c2.numeral);
  var GUITAR = {
    id: "fretboard",
    // mode ID (preserved for backward compat)
    name: "Guitar Fretboard",
    storageNamespace: "fretboard",
    stringCount: 6,
    fretCount: 13,
    // frets 0–12
    stringNames: ["e", "B", "G", "D", "A", "E"],
    stringOffsets: [4, 11, 7, 2, 9, 4],
    // semitones from C per string
    defaultString: 5,
    // low E
    fretMarkers: [3, 5, 7, 9, 12]
  };
  var STRING_NAMES = GUITAR.stringNames;
  var STRING_OFFSETS = GUITAR.stringOffsets;
  var SOLFEGE_MAP = {
    C: "Do",
    D: "Re",
    E: "Mi",
    F: "Fa",
    G: "Sol",
    A: "La",
    B: "Si"
  };
  var _useSolfege = false;
  try {
    _useSolfege = localStorage.getItem("fretboard_notation") === "solfege";
  } catch (_2) {
  }
  function displayNote(name) {
    if (!name) return name;
    const letter = name[0].toUpperCase();
    const acc = name.slice(1).replace(/#/g, "\u266F").replace(/b/g, "\u266D");
    if (!_useSolfege) {
      return name[0] + acc;
    }
    const syl = SOLFEGE_MAP[letter];
    if (!syl) return name[0] + acc;
    const out = name[0] === name[0].toLowerCase() ? syl.toLowerCase() : syl;
    return out + acc;
  }

  // src/stats-display.ts
  var _heatmapColors = null;
  function cssVar(name) {
    try {
      const val = getComputedStyle(document.documentElement).getPropertyValue(
        name
      ).trim();
      if (val) return val;
    } catch (_2) {
    }
    return "";
  }
  function heatmapColors() {
    if (!_heatmapColors) {
      _heatmapColors = {
        none: cssVar("--heatmap-none") || "hsl(30, 4%, 85%)",
        level: [
          cssVar("--heatmap-1") || "hsl(12, 48%, 65%)",
          cssVar("--heatmap-2") || "hsl(30, 48%, 58%)",
          cssVar("--heatmap-3") || "hsl(50, 40%, 50%)",
          cssVar("--heatmap-4") || "hsl(72, 38%, 42%)",
          cssVar("--heatmap-5") || "hsl(90, 45%, 35%)"
        ]
      };
    }
    return _heatmapColors;
  }
  function heatmapNeedsLightText(color) {
    const m2 = color && color.match(/,\s*(\d+)%\s*\)/);
    return m2 ? parseInt(m2[1], 10) <= 50 : false;
  }
  function getAutomaticityColor(auto) {
    const c2 = heatmapColors();
    if (auto === null) return c2.none;
    if (auto > 0.8) return c2.level[4];
    if (auto > 0.6) return c2.level[3];
    if (auto > 0.4) return c2.level[2];
    if (auto > 0.2) return c2.level[1];
    return c2.level[0];
  }

  // node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js
  var f2 = 0;
  function u2(e2, t2, n2, o2, i2, u3) {
    t2 || (t2 = {});
    var a2, c2, p2 = t2;
    if ("ref" in p2) for (c2 in p2 = {}, t2) "ref" == c2 ? a2 = t2[c2] : p2[c2] = t2[c2];
    var l2 = { type: e2, props: p2, key: n2, ref: a2, __k: null, __: null, __b: 0, __e: null, __c: null, constructor: void 0, __v: --f2, __i: -1, __u: 0, __source: i2, __self: u3 };
    if ("function" == typeof e2 && (a2 = e2.defaultProps)) for (c2 in a2) void 0 === p2[c2] && (p2[c2] = a2[c2]);
    return l.vnode && l.vnode(l2), l2;
  }

  // src/ui/preview.tsx
  function Section({ title, children }) {
    return /* @__PURE__ */ u2("section", { class: "preview-section", children: [
      /* @__PURE__ */ u2("h3", { children: title }),
      /* @__PURE__ */ u2("div", { class: "preview-frame", children })
    ] });
  }
  var ALL_NOTES = [
    "C",
    "C#",
    "D",
    "D#",
    "E",
    "F",
    "F#",
    "G",
    "G#",
    "A",
    "A#",
    "B"
  ];
  var ACCIDENTALS = ["C#", "D#", "F#", "G#", "A#"];
  var NATURALS = ["C", "D", "E", "F", "G", "A", "B"];
  var INTERVALS = [
    "m2",
    "M2",
    "m3",
    "M3",
    "P4",
    "TT",
    "P5",
    "m6",
    "M6",
    "m7",
    "M7",
    "P8"
  ];
  function NoteButtonsDemo() {
    return /* @__PURE__ */ u2("div", { class: "answer-buttons answer-buttons-notes", children: ALL_NOTES.map((n2) => /* @__PURE__ */ u2(
      "button",
      {
        type: "button",
        class: "answer-btn answer-btn-note",
        "data-note": n2,
        children: displayNote(n2)
      },
      n2
    )) });
  }
  function PianoButtonsDemo() {
    return /* @__PURE__ */ u2("div", { class: "note-buttons", children: [
      /* @__PURE__ */ u2("div", { class: "note-row-accidentals", children: ACCIDENTALS.map((n2) => /* @__PURE__ */ u2(
        "button",
        {
          type: "button",
          class: "note-btn accidental",
          "data-note": n2,
          children: displayNote(n2)
        },
        n2
      )) }),
      /* @__PURE__ */ u2("div", { class: "note-row-naturals", children: NATURALS.map((n2) => /* @__PURE__ */ u2("button", { type: "button", class: "note-btn", "data-note": n2, children: displayNote(n2) }, n2)) })
    ] });
  }
  function IntervalButtonsDemo() {
    return /* @__PURE__ */ u2("div", { class: "answer-buttons answer-buttons-intervals", children: INTERVALS.map((i2) => /* @__PURE__ */ u2(
      "button",
      {
        type: "button",
        class: "answer-btn answer-btn-interval",
        "data-interval": i2,
        children: i2
      },
      i2
    )) });
  }
  function NumberButtonsDemo() {
    return /* @__PURE__ */ u2("div", { class: "answer-buttons answer-buttons-numbers", children: Array.from(
      { length: 12 },
      (_2, i2) => /* @__PURE__ */ u2(
        "button",
        {
          type: "button",
          class: "answer-btn answer-btn-num",
          "data-num": String(i2),
          children: i2
        },
        i2
      )
    ) });
  }
  function StatsGridDemo() {
    const cols = ["+1", "+2", "+3", "+4", "+5", "+6"];
    function mockAuto(noteIdx, colIdx) {
      if (noteIdx >= 5) return null;
      if (noteIdx === 4 && colIdx > 1) return null;
      return Math.max(0, Math.min(1, 0.95 - noteIdx * 0.12 - colIdx * 0.15));
    }
    return /* @__PURE__ */ u2("table", { class: "stats-grid", children: [
      /* @__PURE__ */ u2("thead", { children: /* @__PURE__ */ u2("tr", { children: [
        /* @__PURE__ */ u2("th", {}),
        cols.map((c2) => /* @__PURE__ */ u2("th", { children: c2 }, c2))
      ] }) }),
      /* @__PURE__ */ u2("tbody", { children: NOTES.map((note, ni) => /* @__PURE__ */ u2("tr", { children: [
        /* @__PURE__ */ u2("td", { class: "stats-grid-row-label", children: displayNote(note.name) }),
        cols.map((_2, ci) => {
          const auto = mockAuto(ni, ci);
          const color = getAutomaticityColor(auto);
          const light = heatmapNeedsLightText(color);
          return /* @__PURE__ */ u2(
            "td",
            {
              class: "stats-cell",
              style: {
                background: color,
                color: light ? "white" : void 0
              }
            },
            ci
          );
        })
      ] }, note.name)) })
    ] });
  }
  function PreviewApp() {
    return /* @__PURE__ */ u2("div", { children: [
      /* @__PURE__ */ u2("h2", { children: "Answer Buttons" }),
      /* @__PURE__ */ u2(Section, { title: "Note Buttons (Grid)", children: /* @__PURE__ */ u2(NoteButtonsDemo, {}) }),
      /* @__PURE__ */ u2(Section, { title: "Piano Note Buttons", children: /* @__PURE__ */ u2(PianoButtonsDemo, {}) }),
      /* @__PURE__ */ u2(Section, { title: "Interval Buttons", children: /* @__PURE__ */ u2(IntervalButtonsDemo, {}) }),
      /* @__PURE__ */ u2(Section, { title: "Number Buttons (0\u201311)", children: /* @__PURE__ */ u2(NumberButtonsDemo, {}) }),
      /* @__PURE__ */ u2("h2", { children: "Stats" }),
      /* @__PURE__ */ u2(Section, { title: "Recall Heatmap (stats-grid)", children: /* @__PURE__ */ u2(StatsGridDemo, {}) })
    ] });
  }
  var root = document.getElementById("preview-root");
  if (root) J(/* @__PURE__ */ u2(PreviewApp, {}), root);
})();

  </script>
</body>
</html>